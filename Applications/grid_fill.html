<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Applications/grid_fill.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:08:42 GMT -->
<head>
<meta name="description" content="NCL data analysis example page. 
Demonstrates how to fill regions of missing data.">
<TITLE>NCL: Grid Filling</TITLE>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../Document/Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../Document/Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../overview.html" class="subitem">Overview</a></li>
						<li><a href="../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../Document/index.html" class="subitem">Documentation</a></li>						
						<li><a href="../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="list_io.html" class="subitem">File I/O</a></li>
						<li><a href="list_data.html" class="subitem">Datasets</a></li>
						<li><a href="list_maps.html" class="subitem">Maps</a></li>
						<li><a href="list_models.html" class="subitem">Models</a></li>
						<li><a href="list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../Document/Functions/list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../Document/Functions/list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../Document/Functions/index.html" class="subitem">Category Listing</a></li>
						<li><a href="../Document/Functions/list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../Document/Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../Document/Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../Document/Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../Document/Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../Document/Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../Document/Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../Document/Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../Document/Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../Document/Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../Document/Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../Document/Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../Document/Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../Document/Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../Document/Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../Document/Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../Document/Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../Document/Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../Document/Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../Document/Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../Document/Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../Document/Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../Document/Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../Document/Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../Document/Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../Document/Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../Document/Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../Document/Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../Document/Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../Document/Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../Document/Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../Document/Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../Document/Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../Document/Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../Document/Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../Document/Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../Document/Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../Document/Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../Document/Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../Document/Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../Document/Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../Document/Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../Document/Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../Document/Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../Document/Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../Document/index.html" class="subitem">Documentation</a></li>
						<li><a href="../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">

<font size=-1><a href="../index-2.html">NCL Home></a>
<a href="index-2.html">Application examples></a>
<a href="list_dataP.html">Data Analysis</a> ||
<a href="Data/index.html">Data files for some examples</a><p>
Example pages containing:
<a href="concepts_list.html">tips</a> |
<a href="res_list.html">resources</a> | 
<a href="func_list.html">functions/procedures</a>
</font>

<br>
<h1>NCL: Grid Filling</h1>

<div class=mainimage>
<img src="Images/grid_fill_2_1_lg.png">
</div>


<div class=text>

Sometimes, it is desirable to 'fill' regions containing 
missing values [_FillValue] with interpolated values while
leaving the original values unchanged. 
<a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a> performs this task. 
Input values are unchanged and act a boundary conditions (constraints).
Generally, in regions bounded by valid data, this function does a
'pretty good job'. This function will extrapolate beyond data boundaries
and, as always, extrapolated values should be used with caution.

</div>

<div class=ex>
<!--grid_fill_1-->
<a name=ex1></a>
<a href="Images/grid_fill_1_lg.png">
<img src="Images/grid_fill_1_sm.png" align=left border=2></a>
<a href="Scripts/grid_fill_1.html">grid_fill_1.ncl</a>: 
For demonstration purposes, create a grid using <a href="../Document/Functions/Built-in/generate_2d_array.html"><strong>generate_2d_array</strong></a>; 
then use array syntax to set regions to missing values [_FillValue].
Use <a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a> to fill the missing regions.
The top plot is the original grid; the middle plot shows the regions
which were manually set to _FillValue; the bottom plot show the
plot after <a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a> was used.
<p>
</div>

<div class=ex>
<!--grid_fill_2-->
<a name=ex2></a>
<a href="Images/grid_fill_2_1_lg.png">
<img src="Images/grid_fill_2_1_sm.png" align=left border=2></a>
<a href="Images/grid_fill_2_2_lg.png">
<img src="Images/grid_fill_2_2_sm.png" align=left border=2></a>
<a href="Scripts/grid_fill_2.html">grid_fill_2.ncl</a>:

Read SST data which contains missing values (_FillValue) over land. 
Use <a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a> to fill the missing regions.
The left plot show the global reconstruction; the right plot shows
the result when operating over a limited region. Note that
the values over South America were extrapolted.

<p>
</div>

<div class=ex>
<!--grid_fill_3-->
<a name=ex3></a>
<a href="Images/grid_fill_3_1_lg.png">
<img src="Images/grid_fill_3_1_sm.png" align=left border=2></a>
<a href="Images/grid_fill_3_2_lg.png">
<img src="Images/grid_fill_3_2_sm.png" align=left border=2></a>
<a href="Images/grid_fill_3_3_lg.png">
<img src="Images/grid_fill_3_3_sm.png" align=left border=2></a>
<a href="Scripts/grid_fill_3.html">grid_fill_3.ncl</a>:

Read hybrid model level data; use <a href="../Document/Functions/Built-in/vinth2p.html"><strong>vinth2p</strong></a> or
<a href="../Document/Functions/Built-in/vinth2p_ecmwf.html"><strong>vinth2p_ecmwf</strong></a> to interpolate the data
to user specified constant pressure levels. Data below
the surface pressure [PS] are not available. Hence, 
extrapolation or grid filling (<a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a>)
must be used. 
<p>
For demonstration purposes the 950 hPa level was chosen. In each
figure the top plot shows the original grid. The clear areas represent
regions where 950hPa was below the corresponding surface pressure.
The middle plots show the result after using <a href="../Document/Functions/Built-in/vinth2p_ecmwf.html"><strong>vinth2p_ecmwf</strong></a>
to interpolate temperature, specific humidity and geopotential height.
The bottom plot shows the result after using <a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a>. 
<p>

If the clear areas is bounded by valid grid points,
the <a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a> produces reasonable
patterns. The area where values look unreasonable are the grid points
over the Antarctic. This is because to points are not
bounded. The <a href="../Document/Functions/Built-in/vinth2p_ecmwf.html"><strong>vinth2p_ecmwf</strong></a> has problems when it is
used to extrapolate at levels well below the surface pressure level.
</div>

<div class=ex>
<!--grid_fill_4-->
<a name=ex4></a>
<a href="Images/grid_fill_4_1_lg.png">
<img src="Images/grid_fill_4_1_sm.png" align=left border=2></a>
<a href="Images/grid_fill_4_2_lg.png">
<img src="Images/grid_fill_4_2_sm.png" align=left border=2></a>
<a href="Images/grid_fill_4_3_lg.png">
<img src="Images/grid_fill_4_3_sm.png" align=left border=2></a>
<a href="Scripts/grid_fill_4.html">grid_fill_4.ncl</a>:

This is similar to example 3. Here the focus was in a region which
included the Himalaya rather than the globe.  It more clearly
illustrates the strengths/weaknesses
of <a href="../Document/Functions/Built-in/vinth2p_ecmwf.html"><strong>vinth2p_ecmwf</strong></a> and
<a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a>.
<p>

The <b>Z3</b> variable is interpolated to constant pressure levels.
The constant pressure levels include 600, 700, 800, 900, 950, 1000.
Each of the 3 images contains two horizontal rows.  The leftmost plot
contains the 600 & 700hPa levels; the middle image the 800 & 900hPa
levels; the rightmost imnage the 950 & 1000 hPa levels.  The left
figure of each plot shows the interpolated <b>Z3</b> with no
extrapolation.  Non-colored areas indicate regions (grid points) that
are below the surface pressure.  The middle plots show the level after
interpolation by <a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a>.  The rightmost
plots show the result of applying <a href="../Document/Functions/Built-in/vinth2p_ecmwf.html"><strong>vinth2p_ecmwf</strong></a>.
<p>

Note that the <a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a> (middle) plots
generally look "reasonable" as long as there are boundary
values. Clearly the 1000 hPa level at the northern boundary look
unusual. At the lower levels the <a href="../Document/Functions/Built-in/vinth2p_ecmwf.html"><strong>vinth2p_ecmwf</strong></a> are
on a different scale.

</div>

<div class=ex>
<!--grid_fill_5-->
<a name=ex5></a>
<a href="Images/grid_fill_5_lg.png">
<img src="Images/grid_fill_5_sm.png" align=left border=2></a>
<a href="Scripts/grid_fill_5.html">grid_fill_5.ncl</a>:
<a href="https://www.ospo.noaa.gov/Products/land/smops/">
<b>SMOPS</b></a> (Soil Moisture Operational Products System) estimates for a day are read. 
There are 'swath gaps' over land which contain _FillValue. These are colored as yellow
in the figures.  NCL's <a href="../Document/Functions/Built-in/_b_poisson_grid_fill_/b_.html"><strong><b>poisson_grid_fill</b></strong></a> is used to fill
these gaps. It also fills <b>all</b> grid points with _FillValue. NCL's  
<a href="../Document/Functions/Shea_util/landsea_mask.html"><strong>landsea_mask</strong></a> is used to mask ocean, inland water and 
ice regions.
</div>

   <div class=ex>
   <!--MOPITT_MOP03M_3-->
   <a name=MOPITT_ex3></a>
   <a href="Images/MOPITT_MOP03M_3_1_lg.png">
   <img src="Images/MOPITT_MOP03M_3_1_sm.png" align=left border=2></a>
   <a href="Images/MOPITT_MOP03M_3_2_lg.png">
   <img src="Images/MOPITT_MOP03M_3_2_sm.png" align=left border=2></a>
   <a href="Scripts/MOPITT_MOP03M_3.html">MOPITT_MOP03M_3.ncl</a>:
Read a variable and interpolate to a much coarser 46x72 grid using
<a href="../Document/Functions/Contributed/linint2_Wrap.html"><strong>linint2_Wrap</strong></a> and
<a href="../Document/Functions/Contributed/area_hi2lores_Wrap.html"><strong>area_hi2lores_Wrap</strong></a>.
Missing areas are present. Then use <a href="../Document/Functions/Built-in/poisson_grid_fill.html"><strong>poisson_grid_fill</strong></a>
to fill in the missing values and repeat the interpolations.
   </div>

		</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Applications/grid_fill.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:08:49 GMT -->
</html>


