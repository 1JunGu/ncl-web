<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Contributed/cohsq_p2c.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:17 GMT -->
<head>
<meta name="description" content="NCL contributed.ncl functions (statistics)">
<meta name="keywords" content="cohsq_p2c">
<title>cohsq_p2c</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../math.html">General applied math</a>,
<a class=crumb href="../statistics.html">Statistics</a>
<br>
<h1>cohsq_p2c</h1>

<p>
Calculate the value(s) of coherence-squared required for a specified significance level and effectiove degrees-of-freedom.
</p>

<p>
<img src="https://www.ncl.ucar.edu/Images/new.gif"> <i>Available in <a href="../../../prev_releases.html#6.4.0">version 6.4.0</a> and later.</i>
<p>
<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/contributed.ncl"  ; This library is <b>automatically loaded</b>
                                                             ; from NCL V6.2.0 onward.
                                                             ; No need for user to explicitly load.

	function cohsq_p2c (
		prob  : numeric,  ; float or double
		edof  : numeric   
	)

	<a href="../return_val.html">return_val</a>  :  An array of the same size, shape and shape  as <em>prob</em>.
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>prob</em>
<p class=indent>A scalar or array containing probabilities (0 to 1.0).
</p>
<em>edof</em>
<p class=indent>A scalar or array containing the effective degrees-of-freedom. If an array, it must match
the size and shape as <em>prob</em>.
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
Numeric (float or double) array containing coherence-squared of the same size and shape as <em>prob</em>.
</p><a name="Description"></a>
<h2>Description</h2>
<p>
<p>
The coherence-squared is a statistic that can be used to examine the degree of linear association between 
two series. It allows identification of significant frequency-domain correlation between the two time series.
It is analogous to the coefficient of determination (square of the correlation coefficient) between two series.
<p>
<b>NOTE: Phase estimates in the cross spectrum are only useful where significant frequency-domain correlation exists.</b>
<p>
NCL's <a href="../Built-in/specxy_anal.html"><strong>specxy_anal</strong></a> returns the total (FFT-based) degrees of freedom. 
The effective degrees-of-freedom (<em>edof</em>) is half that number. (See Example 4)  
<pre>
<b>References: </b>

Data Analysis Methods in Physical Oceanography /
  William J. Emery; Thomson, Richard E.
  Elsevier, 2001 (2nd Edition); ISBN: 0444507566 (hardbound); 0444507574 (paperback).

<a href="http://www.atmos.washington.edu/~dennis/552_Notes_6c.pdf"><b>Course Notes</b></a>
  Dennis Hartmann (Univ. Washington)
  See Table 6.2 , page 187 and the associated caption on page 186
 
<a href="http://dx.doi.org/10.1175/1520-0469(1975)032<0836:COTDOS>2.0.CO;2">
<b>Comments on the Determination of Significance Levels of the Coherence Statistic</b></a>
   Paul R. Julian
   J. of Atm. Sci. (1975), Volume <b>32</b>, pp 836-837. 

<a href="http://dx.doi.org/10.1175/1520-0469(1979)036<2020:CSL>2.0.CO;2"><b>Coherence Significance Levels</b></a>
   Rory O. R. Y. Thompson
   Journal of the Atmospheric Sciences, 1979
   Volume <b>36</b>, pp 2020-2021

-------------------------------------------------------------------------------
Tables of the Distribution of the Coefficient of Coherence 
          for Stationary Bivariate Gaussian Processes
   Amos, D.  E., and L.  H.  Koopmans (1963) 
   Washington, Office of Technical  Services, Dept.  of Commerce. 

On the Joint Estimation of the Spectra, Cospectrum and Quadrature Spectrum of a 
          Two-dimensional Stationary Gaussian Process 
   Goodman, N.R. (1957)
   New York University
</pre>


</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
<a href="cohsq_c2p.html"><strong>cohsq_c2p</strong></a>,
<a href="../Built-in/specxy_anal.html"><strong>specxy_anal</strong></a>
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
The following match the numbers of Hartmann's Table 6.2.
Note: The examples use nice round effective degrees of freedom but, they may be fractional (eg: 20.37):
<p>
<b>Example 1</b>: Both <em>prob</em> and <em>edof</em> are scalars: 
<pre>
    p    = 0.95 
    edof = 10
    c2   = <strong>cohsq_p2c</strong>(c2, edof)        ; c2 = 0.283
</pre>
<p>
<b>Example 2</b>: The <em>prob</em> is an array and <em>edof</em> is a scalar:
<pre>
    p    = (/0.50, 0.90, 0.95, 0.99, 0.999 /)
    edof = 20                       
    c2   = <strong>cohsq_p2c</strong>(c2, edof)        ; c2(5)
                                      ; c2 = (/0.036, 0.112, 0.146, 0.215, 0.305 /) 
</pre>
<p>
<b>Example 3</b>: Both <em>prob</em> and <em>edof</em> are arrays which have the same shape and size:
<pre>
    p    = /0.50, 0.90, 0.95, 0.99, 0.999 /)
    edof = (/  5  ,  10  ,  20  ,  50  ,  100  /)  ; edof(5)
    c2   = <strong>cohsq_p2c</strong>(p , edof)        ; c2_1(5)
                                      ; c2 = (/0.159, 0.226, 0.146, 0.089, 0.067 /) 
</pre>
<p>
<b>Example 4</b>: Calculate the minimum coherence-squared value required for the 95% level   
given the degrees of freedom returned by <a href="../Built-in/specxy_anal.html"><strong>specxy_anal</strong></a>.  
The <a href="../Built-in/specxy_anal.html"><strong>specxy_anal</strong></a> function explicitly 
returns the total (FFT-based) degrees-of-freedom.

<pre>
    d     = 0                     ; detrending opt: 0=>remove mean 1=>remove mean and detrend
    sm    = 7                     ; smoothing periodogram: should be at least 3 and odd
    pct   = 0.10                  ; percent tapered: 0.10 common. 

                                  ; calculate the cross-spectrum
    sxydof= <a href="../Built-in/specxy_anal.html"><strong>specxy_anal</strong></a>(x,y,d,sm,pct)   ; <b>sxydof is a scalar; FFT-based dof</b>
    <a href="../Built-in/printVarSummary.html"><strong>printVarSummary</strong></a>(sxydof)   ; look at the returned variable

    <b>edof  = sxydof/2 </b>             ; effective degrees of freedom

    p_95  = 0.95
    c2_95 = <strong>cohsq_p2c</strong>(p_95, edof) ; c2_95 is a scalar 
    <a href="../Built-in/print.html"><strong>print</strong></a>("c2_95="+<a href="../Built-in/sprintf.html"><strong>sprintf</strong></a>("%6.3f", c2_95))

                                  ; count the number of returned coherence-squared (sdof@coher2)
                                  ; that exceed the critical value
    n_95  = num(sxydof@coher2 .ge. c2_95)

    print( n_95)
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Contributed/cohsq_p2c.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:17 GMT -->
</html>
