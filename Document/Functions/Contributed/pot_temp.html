<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Contributed/pot_temp.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:19:03 GMT -->
<head>
<meta name="description" content="NCL contributed.ncl functions (meteorology)">
<meta name="keywords" content="pot_temp">
<title>pot_temp</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../meteo.html">Meteorology</a>
<br>
<h1>pot_temp</h1>

<p>
Compute potential temperature.
</p>

<p>
<img src="https://www.ncl.ucar.edu/Images/new.gif"> <i>Available in <a href="../../../prev_releases.html#6.3.0">version 6.3.0</a> and later.</i>
<p>
<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/contributed.ncl"  ; This library is <b>automatically loaded</b>
                                                             ; from NCL V6.2.0 onward.
                                                             ; No need for user to explicitly load.

	function pot_temp (
		p       : numeric,  ; float, double, integer only
		t       : numeric,  
		dim [1] : integer,  
		opt [1] : logical   
	)

	<a href="../return_val.html">return_val</a> [<a href="../Built-in/dimsizes.html"><strong>dimsizes</strong></a>(<em>t</em>)] :  float or double
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>p</em>
<p class=indent>Array containing pressure levels (Pa).
</p>
<em>t</em>
<p class=indent>Array containing temperatures (K).
</p>
<em>dim</em>
<p class=indent>The dimension of <em>t</em> which corresponds to <em>p</em>. 
<b>NOTE:</b> If the rank and sizes of <em>t</em> are the same as those of <em>p</em> this argument is ignored.
A suggested placeholder is <em>dim</em>=-1.
</p>
<em>opt</em>
<p class=indent>option. Currently not used. Set to False
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
A multi-dimensional array of the same size and shape as <em>t</em>. The output will be double 
if <em>t</em> is of type double.
</p><a name="Description"></a>
<h2>Description</h2>
<p>
<p>
Calculate the potential temperature (theta) via the standard meteorological formula:
<pre>

         <b>theta = t*(p0/p)^0.286</b>

</pre>
The function does check units (if present) to make sure they are correct.
<p>
Also, the equivalent temperature (<em>teqv</em>) could be input. The equivalent temperature 
represents an air parcel from which all the water vapor has been extracted by an adiabatic process.
It may be calculated via:
<pre>
         cpd  = 1004. or 1005.7 ; specific heat dry air [J/kg/K]
         Lv   = 2.5104e6        ; [J/kg]=[m2/s2]  Latent Heat of Vaporization of Water
         r    = mixing_ratio    ; [kg/kg]; same size and shape as <em>t</em> 
         teqv = t + (Lv/cpd)*r  ;   
</pre>
<P>
From Wikipedia: "Potential temperature is a more dynamically important quantity than the actual temperature. 
This is because it is not affected by the physical lifting or sinking associated with flow over obstacles 
or large-scale atmospheric turbulence. A parcel of air moving over a small mountain will expand and cool 
as it ascends the slope, then compress and warm as it descends on the other side- but the potential 
temperature will not change in the absence of heating, cooling, evaporation, or condensation (processes that 
exclude these effects are referred to as dry adiabatic). Since parcels with the same potential temperature 
can be exchanged without work or heating being required, lines of constant potential temperature are 
natural flow pathways."

</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
<a href="static_stability.html"><strong>static_stability</strong></a>,
<a href="wind_component.html"><strong>wind_component</strong></a>, <a href="wind_direction.html"><strong>wind_direction</strong></a>
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<B>Example 1</B>
<pre>

; PRESSURE
     p1  =(/ 1008.,1000.,950.,900.,850.,800.,750.,700.,650.,600., \
               550.,500.,450.,400.,350.,300.,250.,200., \
               175.,150.,125.,100., 80., 70., 60., 50., \
                40., 30., 25., 20. /)*100
     p1@units = "Pa"

; TEMPERATURE (C)
     t1  =(/  29.3,28.1,23.5,20.9,18.4,15.9,13.1,10.1, 6.7, 3.1,   \
              -0.5,-4.5,-9.0,-14.8,-21.5,-29.7,-40.0,-52.4,   \
             -59.2,-66.5,-74.1,-78.5,-76.0,-71.6,-66.7,-61.3, \
             -56.3,-51.7,-50.7,-47.5 /)

     t1  = t1 + 273.15
     t1@units = "degK"
     
     dim = 0
     pt1 = <strong>pot_temp</strong>(p1, t1, 0, False)  ; dim=0

</pre>
would yield
<pre>

     Variable: pt1
     Type: float
     Total Size: 120 bytes
                 30 values
     Number of Dimensions: 1
     Dimensions and sizes:   [30]
     Coordinates: 
     Number Of Attributes: 2
       long_name :   <b>potential temperature</b>
       units :       <b>K</b>
     
             <b> p(Pa)   t(K)    pot(K) </b>
     (0)     100800  302.45  301.762
     (1)     100000  301.25  301.25
     (2)      95000  296.65  301.034
     (3)      90000  294.05  303.045
     (4)      85000  291.55  305.421
     (5)      80000  289.05  308.098
     (6)      75000  286.25  310.798
     (7)      70000  283.25  313.669
     (8)      65000  279.85  316.543
     (9)      60000  276.25  319.706
     (10)     55000  272.65  323.491
     (11)     50000  268.65  327.553
     (12)     45000  264.15  331.919
     (13)     40000  258.35  335.753
     (14)     35000  251.65  339.777
     (15)     30000  243.45  343.521
     (16)     25000  233.15  346.597
     (17)     20000  220.75  349.789
     (18)     17500  213.95  352.211
     (19)     15000  206.65  355.528
     (20)     12500  199.05  360.783
     (21)     10000  194.65  376.058
     (22)      8000  197.15  405.988
     (23)      7000  201.55  431.206
     (24)      6000  206.45  461.598
     (25)      5000  211.85  499.026
     (26)      4000  216.85  544.465
     (27)      3000  221.45  603.697
     (28)      2500  222.45  638.883
     (29)      2000  225.65  690.782

</pre>
<p>
<B>Example 2</B>: Calculate the potential temperature for each. Some examples:
<p>
<pre>
Let <em>p1</em> be a one-dimensional array containing isobaric levels: p1(klev);      
Let <em>p2</em> be a two-dimensional array with pressure levels: p2(klev,ncol);
Let <em>p3</em> be a three-dimensional array with pressure levels: p3(klev,nlat,mlon);
Let <em>p4</em> be a four-dimensional  array with pressure levels: p4(ntim,klev,nlat,mlon); 
Let <em>p5</em> be a four-dimensional  array with pressure levels: p5(ncase,ntim,klev,nlat,mlon); 

Let <em>P3</em> be a three-dimensional array with pressure levels: P3(ntim,klev,ncol);
Let <em>P4</em> be a  four-dimensional array with pressure levels: P4(ncase,ntim,klev,ncol);

let <em>t1</em> be a   one-dimensional t1(klev);                    (<b>0</b>)
let <em>t2</em> be a   two-dimensional t2(klev,ncol);               (<b>0</b>,1)
let <em>t3</em> be a three-dimensional t3(klev,nlat,mlon);          (<b>0</b>,1,2)
let <em>t4</em> be a four-dimensional  t4(ntim,klev,nlat,mlon);     (0,<b>1</b>,2,3)
let <em>t5</em> be a five-dimensional  t5(nens,ntim,klev,nlat,mlon) (0,1,<b>2</b>,3,4)

Let <em>T3</em> be a three-dimensional array: T3(ntim,klev,ncol);        (0,<b>1</b>,2)
Let <em>T4</em> be a  four-dimensional array: T4(ncase,ntim,klev,ncol);  (0,1,<b>2</b>,3)

</pre>
<pre>
          ; isobaric 
     pt1  = <strong>pot_temp</strong>(p1 ,t1 , 0, False)
     pt2  = <strong>pot_temp</strong>(p1 ,t2 , 0, False)
     pt3  = <strong>pot_temp</strong>(p1 ,t3 , 0, False)
     pt4  = <strong>pot_temp</strong>(p1 ,t4 , 1, False)
     pt5  = <strong>pot_temp</strong>(p1 ,t5 , 2, False)

     pT3  = <strong>pot_temp</strong>(p1 ,T3 , 1, False)
     pT4  = <strong>pot_temp</strong>(p1 ,T4 , 2, False)

          ; non-isobaric (variable ranks match)
     pt11 = <strong>pot_temp</strong>(p1 ,t1 ,-1, False)   ; same as pt1
     pt22 = <strong>pot_temp</strong>(p2 ,t2 ,-1, False)
     pt33 = <strong>pot_temp</strong>(p3 ,t3 ,-1, False)
     pt44 = <strong>pot_temp</strong>(p4 ,t4 ,-1, False)
     pt55 = <strong>pot_temp</strong>(p5 ,t5 ,-1, False)

     PT33 = <strong>pot_temp</strong>(P3 ,T3 ,-1, False)
     PT44 = <strong>pot_temp</strong>(P4 ,T4 ,-1, False)

</pre>
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Contributed/pot_temp.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:19:03 GMT -->
</html>
