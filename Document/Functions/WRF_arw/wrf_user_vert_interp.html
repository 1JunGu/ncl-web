<html>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/WRF_arw/wrf_user_vert_interp.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:19:24 GMT -->
<head>
<meta name="description" content="NCL WRFUserARW.ncl functions (interpolation)">
<meta name="keywords" content="wrf_user_vert_interp">
<title>wrf_user_vert_interp</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">

<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../wrf.html">WRF</a>,
<a class=crumb href="../interp.html">Interpolation</a>
<br>
<h1>wrf_user_vert_interp</h1>

<p>
Vertically interpolates ARW WRF variables given the type of surface
and a set of new levels.
</p>

<p>
<img src="https://www.ncl.ucar.edu/Images/new.gif"> <i>Available in <a href="../../../prev_releases.html#6.3.0">version 6.3.0</a> and later.</i>
<p>
<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/gsn_code.ncl"      ; These two libraries are <b>automatically</b>
load "$NCARG_ROOT/lib/ncarg/nclscripts/wrf/WRFUserARW.ncl"    ; <b>loaded</b> from NCL V6.4.0 onward.
                                                              ; No need for user to explicitly load.

	function wrf_user_vert_interp (
		file_handle         : file or list,  
		field               : numeric,       
		vert_coordinate [1] : string,        
		interp_levels   [*] : numeric,       
		opts            [1] : logical        
	)

	<a href="../return_val.html">return_val</a>  :  numeric
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>file_handle</em>
<p class=indent>Reference to an input netCDF file opened
with <a href="../Built-in/addfile.html"><strong>addfile</strong></a>, or list of NetCDF files opened with
<a href="../Built-in/addfiles.html"><strong>addfiles</strong></a>.
</p>
<em>field</em>
<p class=indent>The field variable to be interpolated. This must be a 3D array
dimensioned bottom_top x south_north x west_east, or a 4D array
dimensioned time x bottom_top x south_north x west_east.
</p>
<em>vert_coordinate</em>
<p class=indent>A scalar string indicating the type of surface to interpolate
to. Valid strings are:
</p>
<p class=indent>

<ul>
<li>"pressure", "pres" - pressure [hPa]
<li>"ght_msl"  - grid point height msl [km]
<li>"ght_agl"  - grid point height agl [km]
<li>"theta"  - potential temperature [K]
<li>"theta-e"  - equivalent potential temperature [K]
</ul>
</p>
<em>interp_levels</em>
<p class=indent>A 1D array of vertical levels to interpolate to.
</p>
<em>opts</em>
<p class=indent>A scalar logical that can be set to True to indicate 
additional options attached as attributes. Valid attributes are:
</p>
<p class=indent>

<ul>
<li>opts@<b>extrapolate</b> (logical) - whether to extrapolate values below ground (default=False)
</p>
<p class=indent>

<li>opts@<b>field_type</b> (string) - the type of field; valid values are:
</p>
<p class=indent>

<ul>
<li>"ght"
<li>"pressure", "pres", "p"
<li>"t"
<li>"z"
<li>"none"
</ul>
</p>
<p class=indent>

<li>opts@<b>logP</b> (logical) - use the log of the pressure for
interpolation instead of just pressure (default=False)
</p>
<p class=indent>

<li>opts@<b>time</b> (logical) - the time index used
to extract the variables for interpolation, which should be set to the same time 
index that was used to extract the field that is being 
interpolated (default=-1)<br> (<font color="red"><i>Available in <a href="../../../prev_releases.html#6.4.0">version 6.4.0</a> and later.</i></font>)


</ul>
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
The return variable will be the same dimensionality as <em>field</em>,
except with the level dimension replaced by the number of new levels.
An attribute called "vert_interp_type" will be added to indicate
the type of interpolation done.
<p>
<b> Bug fixed in version 6.4.0</b>: The coordinate variable <i>interp_levels</i> is no 
longer reversed in the returned variable.
</p><a name="Description"></a>
<h2>Description</h2>
<p>
This function does a vertical interpolation of ARW WRF variables to
several possible surfaces: Pressure, Height, AGL, Height MSL,
Potential Temperature and Equivalent Potential Temperature. It also
does an extrapolation below ground level and above the model surfaces.
<p>


<strong>wrf_user_vert_interp</strong> is part of a
library of functions and procedures in <a
href="WRFUserARW.html">WRFUserARW.ncl</a> written to help users
plot ARW WRF model data.
<p>


</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
See the full list of <a href="../wrf.html">WRF
functions</a>.
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<b>Example 1</b><p>

<pre>
  filename = "wrfout_d01_1991-01-01_00:00:00"
  fin      = <a href="../Built-in/addfile.html"><strong>addfile</strong></a>(filename+".nc","r")

  fld = <a href="wrf_user_getvar.html"><strong>wrf_user_getvar</strong></a>(fin,"tk",-1)     ; The variable to interpolate

  vert_coord       = "theta"
  interp_levels    = <a href="../Built-in/ispan.html"><strong>ispan</strong></a>(200,1000,50)
 
  opts             = True
  opts@extrapolate = True 
  opts@field_type  = "T"
  opts@logP        = True 
   
  fld_intrp = <strong>wrf_user_vert_interp</strong>(fin,fld,vert_coord,interp_levels,opts)
  printVarSummary(fld_intrp)
</pre>
<p>

The output will be:
<p>

<pre>
Variable: fld_intrp
Type: float
Total Size: 7493940 bytes
            1873485 values
Number of Dimensions: 4
Dimensions and sizes:[Time | 1] x [interp_levels | 17] x [south_north | 279] x [west_east | 395]
Coordinates: 
            interp_levels: [200..1000]
Number Of Attributes: 8
_FillValue :9.96921e+36
description :Temperature
FieldType :104
MemoryOrder :XYZ
units :K
stagger :
coordinates :XLONG XLAT
vert_interp_type :theta

</pre>

<p>

<b>Example 2</b><p>

<pre>
  in_files = (/"wrfout_d02_2005-08-28_00:00:00", \
                wrfout_d02_2005-08-28_12:00:00", \
                wrfout_d02_2005-08-29_00:00:00"/)
    
  input_list = <a href="../Built-in/addfiles.html"><strong>addfiles</strong></a>(in_files, "r")
    
  timeidx = 6
    
  fld1 = <a href="wrf_user_getvar.html"><strong>wrf_user_getvar</strong></a>(input_list, "tk", timeidx)
  
  vert_coord       = "theta"
  interp_levels    = (/200,300,500,1000/)
   
  opts             = True
  opts@extrapolate = True 
  opts@field_type  = "T"
  opts@logP        = True
  opts@time        = timeidx  
    
  fld1_intrp = <strong>wrf_user_vert_interp</strong>(input_list,fld1,vert_coord,interp_levels,opts)
    
  printVarSummary(fld1_intrp)
</pre>
<p>

The output will be:
<p>

<pre>
Variable: fld1_intrp
Type: float
Total Size: 147456 bytes
            36864 values
Number of Dimensions: 3
Dimensions and sizes:   [interp_levels | 4] x [south_north | 96] x [west_east | 96]
Coordinates: 
            interp_levels: [200..1000]
Number Of Attributes: 8
  _FillValue :  9.96921e+36
  description : Temperature
  coordinates : XLONG XLAT XTIME
  stagger : 
  units :   K
  MemoryOrder : XYZ
  FieldType :   104
  vert_interp_type :    theta

</pre>
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/WRF_arw/wrf_user_vert_interp.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:19:24 GMT -->
</html>
