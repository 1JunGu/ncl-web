<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/hydro.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:41 GMT -->
<head>
<meta name="description" content="NCL built-in functions (meteorology)">
<meta name="keywords" content="hydro">
<title>hydro</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../meteo.html">Meteorology</a>
<br>
<h1>hydro</h1>

<p>
Computes geopotential height using the hydrostatic equation.
</p>

<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
	function hydro (
		p     : numeric,  
		tkv   : numeric,  
		zsfc  : numeric   
	)

	<a href="../return_val.html">return_val</a> [<a href="dimsizes.html"><strong>dimsizes</strong></a>(p)] :  numeric
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>p</em>
<p class=indent>A multi-dimensional array of pressures in mb. The rightmost dimension must be the
level dimension. The order of the vertical dimension is bottom-to-top. 
The array must include the surface pressure.
</p>
<em>tkv</em>
<p class=indent>A multi-dimensional array of virtual temperature (K) at each pressure specified in 
<em>p</em>. Must be the same size as <em>p</em>. The order of the variable
is bottom-to-top.  The array must include the surface temperature or 
near-surface temperature (eg, the 2-meter temperature).
</p>
<em>zsfc</em>
<p class=indent>A multi-dimensional array of surface geopotential heights (gpm). Must be the same size 
as <em>p</em> minus the rightmost level dimension.
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
A multi-dimensional array of the same size as <em>p</em> and <em>tkv</em>, with 
the rightmost dimension the level dimension.
The output array will be of type double if any of the input is double, and of type 
float otherwise.
</p><a name="Description"></a>
<h2>Description</h2>
<p>
Computes the geopotential height using the hydrostatic equation. The average layer 
temperature is calculated internally. 
<p>
If missing values are encountered in any level of the input parameters then ALL output 
values will be set to missing. A warning message is issued.
<p>
The value of gravity used by this function is 9.80655 m/s^2, which is
the World Meteorological Organization value for gravity at 45 degrees
latitude.
<p>
This function was originally developed for use with rawindsonde data. Typically
the pressure, temperature and humidity data associated with rawindsondes includes
surface or near-surface values in addition to values at assorted pressure levels. 
Model data typically have the variables separated into "upper level"
data and surface or near-surface (eg, 2-meter level) data arrays. The 
<a href="../Contributed/merge_levels_sfc.html"><strong>merge_levels_sfc</strong></a> can be used to
merge the model upper levels and surface/near-surface level. See Example 4. 

</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
Use <a href="cz2ccm.html"><strong>cz2ccm</strong></a> if geopotential heights at hybrid levels are desired.
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<B>Example 1</B>
<P>
Derive geopotential height from a sounding. 
<ul>
<li>the temperatures are not virtual temperatures</li>
<li>degrees C must be converted to K (add 273.15)</li>
<li>to calculate virtual temperature use mixing ratio (unitless)
and the original temperature</li>
</ul>

<PRE>
begin
; PRESSURE (MB)
  p  =(/ 1008.,1000.,950.,900.,850.,800.,750.,700.,650.,600., \
          550.,500.,450.,400.,350.,300.,250.,200., \
          175.,150.,125.,100., 80., 70., 60., 50., \
           40., 30., 25., 20. /)
           
; TEMPERATURE (C)   
  t  =(/  29.3,28.1,23.5,20.9,18.4,15.9,13.1,10.1, 6.7, 3.1,   \
          -0.5,-4.5,-9.0,-14.8,-21.5,-29.7,-40.0,-52.4,   \
         -59.2,-66.5,-74.1,-78.5,-76.0,-71.6,-66.7,-61.3, \
         -56.3,-51.7,-50.7,-47.5 /)
         
; MIXING RATIO (g/kg)
  w  =(/  20.38,19.03,16.14,13.71,11.56,9.80,8.33,6.75,6.06,5.07, \
           3.88, 3.29, 2.39, 1.70,1.00,0.60,0.20,0.00,0.00, \
           0.00, 0.00, 0.00, 0.00,0.00,0.00,0.00,0.00,0.00, \
           0.00, 0.00 /)

  zsfc = 17.0                      
  w    =  w*0.001                   ; make w unitless (ie, kg/kg)
                                    ; calculate virtual temperature
  tkv  = (t+273.15)*(1.+w*0.61)     ; convert C-to-K and multiply
                                    ; by factor involving w

  zh = <strong>hydro</strong> (p,tkv,zsfc)

  print(<a href="sprintf.html"><strong>sprintf</strong></a>("%9.1f", p)+" "+<a href="sprintf.html"><strong>sprintf</strong></a>("%9.1f", tkv)+" "+<a href="sprintf.html"><strong>sprintf</strong></a>("%9.1f", zh))


end
</PRE>
The printed output is:
<pre>

              P       TKV        ZH
(0)	   1008.0     306.2      17.0
(1)	   1000.0     304.7      88.2
(2)	    950.0     299.6     541.9
(3)	    900.0     296.5    1013.6
(4)	    850.0     293.6    1507.2
(5)	    800.0     290.8    2025.7
(6)	    750.0     287.7    2572.1
(7)	    700.0     284.4    3149.8
(8)	    650.0     280.9    3762.9
(9)	    600.0     277.1    4416.6
(10)	    550.0     273.3    5117.5
(11)	    500.0     269.2    5874.3
(12)	    450.0     264.5    6697.3
(13)	    400.0     258.6    7599.2
(14)	    350.0     251.8    8596.8
(15)	    300.0     243.5    9714.6
(16)	    250.0     233.2   10987.0
(17)	    200.0     220.8   12470.2
(18)	    175.0     213.9   13319.9
(19)	    150.0     206.6   14269.0
(20)	    125.0     199.0   15351.9
(21)	    100.0     194.6   16638.0
(22)	     80.0     197.1   17917.3
(23)	     70.0     201.5   18696.3
(24)	     60.0     206.4   19616.5
(25)	     50.0     211.8   20732.3
(26)	     40.0     216.8   22131.9
(27)	     30.0     221.4   23976.4
(28)	     25.0     222.4   25160.8
(29)	     20.0     225.6   26623.8

</pre>

<B>Example 2</B>
<P>
Let p be a one-dimensional array as in example 1.  Let temperature, T,
be a four-dimensional array containing virtual temperatures (K) with
<a href="../../Language/named.html">named dimensions</a>
time, lev, lat, lon.  The geopotential heights are derived using a combination 
of named dimension <a href="../../Language/reorder.html">reordering</a>
and <a href="conform.html"><strong>conform</strong></a>. 
           
<PRE>
  Tnew = T(time|:,lat|:,lon|:,lev|:)
  zh = <strong>hydro</strong> (<a href="conform.html"><strong>conform</strong></a>(Tnew,p,3), Tnew, zsfc)
; result is zh(time,lat,lon,lev)
</PRE>
   
<B>Example 3</B>
<P>
Let sigma be a one-dimensional array of sigma levels. Use <a href="pres_sigma.html"><strong>pres_sigma</strong></a> 
to derive pressures at every level. Furthermore, let the levels be ordered from 
top-to-bottom, therefore requiring <a href="../../Language/reorder.html">
reordering</a> 
           
<PRE>
load "$NCARG_ROOT/lib/ncarg/nclscript/csm/contributed.ncl"

begin
  f = <a href="addfile.html"><strong>addfile</strong></a> ("T6319861201.nc","r")

  sigma = f->sig_level      ; (sig_level)
  T     = f->T              ; (time,sig_level,lat,lon)   [K]
  Q     = f->Q              ; (time,sig_level,lat,lon)   [kg/kg]
           
  ps    = f->PS             ; (time,lat,lon)       [Pa]
  zSfc  = f->PHIS           ; (time,lat,lon)       [m2/s2]
  zSfc  = zSfc/9.80655      ; [gpm]
           
; reuse T array to store virtual temperature
  T     = T*(1.+0.61*Q)     ; compute virtual temperature [K]
  T@long_name = "virtual temperature"
           
  P     = <a href="pres_sigma.html"><strong>pres_sigma</strong></a>(sigma, ps)  ; (ntim,klev,nlat,mlon)  [Pa]
  <a href="../Contributed/copy_VarCoords.html"><strong>copy_VarCoords</strong></a>(T,P) ; copy coordinate metadata
  P@units     =  ps@units
  P@long_name = "pressure"

  P     = P*0.01            ; change units to mb (same as hPa)
  P@units =  "hPa"
                            ; the ::-1 reorders the vertical
  Z     = P(time|:,lat|:,lon|:,sig_level|::-1)
  Z     = <strong>hydro</strong>(P(time|:,lat|:,lon|:,sig_level|::-1) \
               ,T(time|:,lat|:,lon|:,sig_level|::-1) \
               , zSfc)                                ; ntim,klev,nlat,mlon) 
               
  Z@long_name = "geopotential height"
  Z@units     = "gpm"
  
  <a href="printVarSummary.html"><strong>printVarSummary</strong></a>(Z)

  <a href="print.html"><strong>print</strong></a> ("=================")

  <a href="print.html"><strong>print</strong></a>(P(0,::-1,{50},{10})+"  "+T(0,::-1,{50},{10})+"  "+Z(0,{50},{10},:))
end
</PRE>
<p>
This script yields:

<PRE>
Variable: Z
Type: float
Total Size: 8257536 bytes
            2064384 values
Number of Dimensions: 4
Dimensions and sizes:   [time | 4] x [lat | 96] x [lon | 192] x [sig_level | 28]
Coordinates: 
            time: [761880..761898]
            lat: [-88.5722..88.5722]
            lon: [-180..178.125]
            sig_level: [0.995..0.0027]
Number Of Attributes: 2
  units :       gpm
  long_name :   geopotential height

(0)     =================
(0)     968.435  267.176   482.583
(1)     955.88   272.837   585.715
(2)     938.652  277.386   732.164
(3)     917.337  280.123   919.579
(4)     891.447  280.75   1154.57
(5)     860.204  280.07   1447.39
(6)     823.219  279.032  1806.99
(7)     780.004  277.027  2245.82
(8)     730.755  274.753  2772.51
(9)     675.763  270.53   3396.87
(10)    616.003  266.413  4124.51
(11)    552.933  259.41   4955.82
(12)    488.305  252.951  5887.95
(13)    424.068  244.438  6914.88
(14)    362.068  234.922  8024.03
(15)    304.157  224.777  9196.98
(16)    251.306  215.384  10427
(17)    204.491  208.725  11706.9
(18)    163.709  211.983  13076.2
(19)    129.06   212.461  14553.4
(20)    100.055  210.809  16130.4
(21)    76.1122  211.541  17820.9
(22)    56.4515  210.345  19666.1
(23)    40.684   209.046  21676.8
(24)    28.0311  208.019  23950.9
(25)    17.8114  203.253  26682.6
(26)    9.83035  208.781  30261.2
(27)    2.62791  209.469  38331.2
</PRE>

<B>Example 4</B>
<P>
Consider model upper level data and separate surface or near surface arrays.
Merge the data prior to using <strong>hydro</strong>. 
<p>
<PRE>
  f = <a href="addfile.html"><strong>addfile</strong></a> ("foo.nc","r")

  zSfc  = f->geosp           ; (time,lat,lon)       [m2/s2]
  zSfc  = zSfc/9.80655       ; [gpm]

                             ; MODEL upper level variables
  T     = f->t               ; (time,level,lat,lon)   [K]
  Q     = f->q               ; (time,level,lat,lon)   [kg/kg]
  P     = f->p               ; (time,level,lat,lon)   [Pa]
                             
                             ; SURFACE (or NEAR-SURFACE) variables
  PS    = f->psfc            ; (time,lat,lon)       [Pa]
  QS    = f->QREFHT          ; (time,lat,lon)   [kg/kg]
  TS    = f->TREFHT          ; (time,lat,lon)       [Pa]

;*****************************************
; Merge the levels for use by "hydro"
;*****************************************
  TT    = <a href="../Contributed/merge_levels_sfc.html"><strong>merge_levels_sfc</strong></a>(T, TS, -1 )
  QQ    = <a href="../Contributed/merge_levels_sfc.html"><strong>merge_levels_sfc</strong></a>(Q, QS, -1 )
  PP    = <a href="../Contributed/merge_levels_sfc.html"><strong>merge_levels_sfc</strong></a>(P, PS, -1 )
  
;*****************************************
; Compute virtual temperature           
;*****************************************
  TT    = TT*(1.+0.61*QQ)            
  TT@long_name = "virtual temperature"
  
;*****************************************
; Change pressure units to "hPa" as required by 'hydro'    
; Reorder variables for use by hydro 
;*****************************************
  PPnew  = PP(time|:,lat|:,lon|:,LEV|:)
  PPnew  = PPnew*0.01        
  PP@units = "hPa"           
  PPnew@long_name = "pressure"

  TTnew = TT(time|:,lat|:,lon|:,LEV|:)

;*****************************************
; Use hydrostatic eqn and assign appropriate meta data
;*****************************************
  geopoth  = <strong>hydro</strong>(PPnew,TTnew,zSfc)         ; (ntim,nlat,mlon,klev)

  <a href="../Contributed/copy_VarCoords.html"><strong>copy_VarCoords</strong></a> (TTnew, geopoth)             ; copy coordinates

  <a href="printVarSummary.html"><strong>printVarSummary</strong></a> (geopoth)
</PRE>
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/hydro.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:41 GMT -->
</html>
