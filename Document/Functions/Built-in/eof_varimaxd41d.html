<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/eof_varimax.shtml? by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 19:46:13 GMT -->
<head>
<meta name="description" content="NCL built-in functions (empirical orthogonal functions)">
<meta name="keywords" content="eof_varimax">
<title>eof_varimax</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../eofs.html">Empirical orthogonal functions</a>
<br>
<h1>eof_varimax</h1>

<p>
Rotates EOFs using the using Kaiser row normalization and the varimax criterion 
(deprecated version).
</p>

<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
	function eof_varimax (
		evec  : numeric   
	)

	<a href="../return_val.html">return_val</a> [<a href="dimsizes.html"><strong>dimsizes</strong></a>(evec)] :  numeric
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>evec</em>
<p class=indent>A multi-dimensional array containing the EOFs calculated using 
<a href="eofcor.html"><strong>eofcor</strong></a> or <a href="eofcov.html"><strong>eofcov</strong></a>.
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
An array of the same size and type as <em>evec</em>. In addition, as
of <a href="../../../prev_releases.html#4.3.0">version 4.3.0</a>, the
percent variance is returned as an attribute of the returned value
called <em>pcvar_varimax</em>.
</p><a name="Description"></a>
<h2>Description</h2>
<p>
This function is deprecated and has been replaced by the faster 
<a href="eofunc_varimax.html"><strong>eofunc_varimax</strong></a>.
<br><br>
Rotates EOFs using the using Kaiser row normalization and the varimax criterion.
The results are identical to IMSL's "FROTA" routine with the parameters w=1.0 and
eps=0.0001. Currently, the percent variance explained after the rotation is not 
returned by the function. 

<br><br>
The Kaiser varimax rotation is a common rotation performed on atmospheric or
oceanographic data. Rotation of the spatial modes (i.e. EOFs) is called R-mode 
while rotation of the amplitude time series (expansion coefficients) is called Q-mode. 
The focus of Q-mode analysis is interobject relationships. Q-mode analysis is not 
commonly used today due to the advent of cluster analysis.  R-mode rotation focuses 
upon intervariable relationships such as the covariance/correlation between stations 
or grid points.
<br><br>
Generally, it is R-mode rotation that is performed on atmospheric/oceanographic data. 
The objective of R-mode analysis is to derive simple structures.  Under Kaiser 
varimax rotation this is accomplished by performing an orthonormal rotation on a user 
specified number of modes such that some values are near +/- 1 with many near 0 values.
As noted by Trenberth et al. (2004) [<i>title</i> Journal, Vol pp. , ]
the effect is to localize the main centers of action and maximize the regions of 
small weightings. 
<br><br>
The output of conventional eof analysis are spatial patterns (EOFs) and temporal 
series (eof_ts) that are both orthogonal. The result of varimax rotation upon 
standard EOFs are rotated EOFs that are orthonormal. However, the temporal patterns 
derived by projecting the rotated spatial patterns onto the data will not be 
orthogonal. This means that the there is some correlation between the time series 
expansion coefficients for each mode. The reverse is the case for Q-mode analysis.
<br><br>
The results may be very dependent upon the user specified number of modes used in the 
rotation. The "best" number of modes to use may have to be determined by experiment.
<br>
When to use rotation:

<OL>
<LI>Don't use rotation unless you know what you are doing and why you
are doing it!</li>

<LI>If the EOF patterns/coefficients are sufficiently separated (see discussion of 
North's 'rule of thumb' in Storch and Zwiers [<i>Statistical Analysis in Climate
Research</i> Cambridge Univ. Press. 1998] there may be no need to use 
rotation if the patterns can be interpreted in physical terms.</li>

<LI>If none of the patterns/coefficients are distinct then rotation may help reduce 
the noise and yield results that are more interpretable.</li>

<LI>If some are distinct and some are not then performing a rotation will mix the 
results.</li>
</OL>

References on rotation:

<pre>
J.C. Davis: Statistics and Data Analysis in Geology. John Wiley and
Sons, 2nd Ed, 1984.
</pre>

</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
This function is deprecated use: <a href="eofunc_varimax.html"><strong>eofunc_varimax</strong></a>
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<B>Example 1</B>
<p>
Let x be two dimensional with dimensions variables (size = nvar) and time:

<PRE>
  neval  = 3                         ; calculate 3 EOFs out of 7 
  ev     = <a href="eofcor.html"><strong>eofcor</strong></a>(x,neval)   ; ev(neval,nvar)
  
  option      = True
  option@jopt = 1                    ; use correlation matrix
  ev_cor = <a href="eofcor.html"><strong>eofcor</strong></a>(x,neval)  ; ev_cor(neval,nvar)

  ev_rot = <strong>eof_varimax</strong>(ev_cor)
</PRE>

<B>Example 2</B>
<p>
Let x be three-dimensional with dimensions of time, lat, lon. 
<a href="../../Language/reorder.html">Reorder</a> x so that time
is the rightmost dimension:

<PRE>
  y!0    = "time"                  ; name dimensions if not already done 
  y!1    = "lat"                   ; must be named to reorder
  y!2    = "lon"                   

  neval  = nvar                                  ; calculate all EOFs 
  ev     = <a href="eofcor.html"><strong>eofcor</strong></a>(y(lat|:,lon|:,time|:),neval)   
  ; ev(neval,nlat,nlon)
  ev_rot = <strong>eof_varimax</strong>(ev)
</PRE>

<B>Example 3</B>
<p>
Let z be four-dimensional with dimensions lev, lat, lon, and time:

<PRE>
  neval  = 3                       ; calculate 3 EOFs out of klev*nlat*mlon 
  ev     = <a href="eofcor.html"><strong>eofcor</strong></a>(z,neval)      
; ev will be dimensioned neval, level, lat, lon
  ev_rot = <strong>eof_varimax</strong>(ev)
</PRE>

<B>Example 4</B>
<p> Calculate the EOFs at every other point rather. Use of a temporary 
array is NOT necessary but it avoids having to reorder the array twice in
this example:

<PRE>
  neval  = 5                          ; calculate 5 EOFs out of nlat*mlon 
  zTemp  = z(lat|::2,lon|::2,time|:)  ; reorder and use temporary array
  ev     = <a href="eofcor.html"><strong>eofcor</strong></a>(zTemp,neval)   ; ev(neval,nlat/2,mlon/2)
  ev_rot = <strong>eof_varimax</strong>(ev)
</PRE>

<B>Example 5</B>
<p>
Let z be four-dimensional with dimensions level, lat, lon, time. Calculate the
EOFs at one specified level:

<PRE>
  kl     = 3                               ; specify level
  neval  = 8                               ; calculate 8 EOFs out of nlat*mlon 
  ev     = <a href="eofcor.html"><strong>eofcor</strong></a>(z(kl,:,:,:),neval)  
; ev will be dimensioned neval, lat, lon 
  ev_rot = <strong>eof_varimax</strong>(ev)
</PRE>

<B>Example 6</B>
<p>
Let z be four-dimensional with dimensions time, lev, lat, lon. 
<a href="../../Language/reorder.html">Reorder</a> x so that time
is the rightmost dimension and calculate on one specified level:

<PRE>
  kl     = 3                             ; specify level
  neval  = 8                             ; calculate 8 EOFs out of nlat*mlon 
  zTemp  = z(lev|kl,lat|:,lon|:,time|:)   
  ev     = <a href="eofcor.html"><strong>eofcor</strong></a>(zTemp,neval)      
; ev will be dimensioned neval, lat, lon
  ev_rot = <strong>eof_varimax</strong>(ev)
</PRE>

<B>Example 7</B>
<p>
Area weight the data prior to calculation. Let p be four-dimensional with 
dimensions lat, lon, and time. The array lat contains the latitudes.

<PRE>
; calculate the weights using the square root of the cosine of the latitude and
; also convert degrees to radians
  wgt = <a href="sqrt.html"><strong>sqrt</strong></a>(<a href="cos.html"><strong>cos</strong></a>(lat*0.01745329)) 
  
; <a href="../../Language/reorder.html">reorder</a> data so time is fastest varying                                      
  pt  = p(lat|:,lon|:,time|:)         ; (lat,lon,time)
  ptw = pt                            ; create an array with metadata

; weight each point prior to calculation. 
; <a href="conform.html"><strong>conform</strong></a> is used to make wgt the same size as pt
  ptw = pt*<a href="conform.html"><strong>conform</strong></a>(pt, wgt, 0)        
                                      
  evec     = eofcor(ptw,neval)   
  evec_rot = <strong>eof_varimax</strong>(evec)
</PRE>
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/eof_varimax.shtml? by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 19:46:13 GMT -->
</html>
