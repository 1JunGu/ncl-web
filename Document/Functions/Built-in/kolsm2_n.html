<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/kolsm2_n.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:44 GMT -->
<head>
<meta name="description" content="NCL built-in functions (statistics)">
<meta name="keywords" content="kolsm2_n">
<title>kolsm2_n</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../math.html">General applied math</a>,
<a class=crumb href="../statistics.html">Statistics</a>
<br>
<h1>kolsm2_n</h1>

<p>
Uses the Kolmogorov-Smirnov two-sample test to determine if two samples are
from the same distribution.
</p>

<p>
<img src="https://www.ncl.ucar.edu/Images/new.gif"> <i>Available in <a href="../../../prev_releases.html#6.2.0">version 6.2.0</a> and later.</i>
<p>
<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
	function kolsm2_n (
		x        : numeric,  
		y        : numeric,  
		dims [*] : integer   
	)

	<a href="../return_val.html">return_val</a>  :  float or double
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>x</em>
<br>
<em>y</em>
<p class=indent>Arrays of any dimensionality. The rank of the arrays must be the same.
However, the dimension(s) specified by <em>dims</em> may be of different 
sizes. (See Examples.) All other dimensions must match.  
<b>At a minimum, the sample sizes should be greater than 100. Missing 
data are not allowed.  It is the user's responsibility to remove
missing values prior to calling the function.</b>
</p>
<em>dims</em>
<p class=indent>The dimension(s) of <em>x</em> and <em>y</em> on which to calculate the statistic. They must be consecutive and increasing.
</p>
<p class=indent>

The dimension sizes of <em>x</em> and <em>y</em> may be different but
the rank must be the same.<br>
<b>If <em>dims</em>=-1, then the entire arrays will be used.</b>
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
Probability that the distributions are the same.
The return type will be double if either <em>x</em> or <em>y</em>,
is type double, and float otherwise. In addition, two <i>ancillary</i>
statistics used to calculate the probability  are returned as attributes, <em>dstat</em> and <em>zstat</em>.
These are used to compute the returned probability.  For the <strong>kolsm2_n</strong> 
function, these are defined as
<pre>

        <em>dstat</em> = <a href="abs.html"><strong>abs</strong></a>(<em>x</em>-<em>y</em>) 

        <em>zstat</em> = <a href="sqrt.html"><strong>sqrt</strong></a>((M*N)/(M+N))*<em>dstat</em>)
    where
        M, N are the dimension sizes of <em>x</em> and <em>y</em>.

</pre>
</p><a name="Description"></a>
<h2>Description</h2>
<p>
<a name="V630_bug"></a>
<table border=1 cellpadding=1
<tr>
<td><b>Note: a bug was found in which this routine doesn't work across
multiple-dimensioned arrays. This will be fixed
in <a href="../../../prev_releases.html#6.4.0">V6.4.0</a>.

<tr>
<td>You can work around this by using loops, which will be slower:
<p>

<pre>
; Assume:
;   TS_2 is dimensioned nyears1 x nlat x nlon 
;   TS_3 is dimensioned nyears2 x nlat x nlon 
;
  dims = dimsizes(TS_2)
  nlat = dims(1)
  nlon = dims(2)
  ks   = new((/nlat,nlon/),typeof(TS_2))
  ds   = new((/nlat,nlon/),typeof(TS_2))
  zs   = new((/nlat,nlon/),typeof(TS_2))
  do ilat = 0, nlat-1
    do ilon = 0, nlon-1
      ks_single     = <strong>kolsm2_n</strong>(TS_2(:,ilat,ilon),TS_3(:,ilat,ilon),0)
      ks(ilat,ilon) = ks_single
      ds(ilat,ilon) = ks_single@dstat
      zs(ilat,ilon) = ks_single@zstat
    end do
  end do
</pre>
</table>
<p>

The Kolmogorov-Smirnov (KS) two-sample test determines if two samples are 
from the same parent distribution. The KS test is non-parametric and distribution 
free. <i>i.e.,</i>: It makes no assumption about the distribution of data. 
The statistic compares cumulative distributions of two data samples.  A large 
difference between the two cumulative sample distributions indicates 
that data are not drawn from the same distribution. 
<p>
From 
<a href="http://en.wikipedia.org/wiki/Kolmogorovâ€“Smirnov_test">
<b><font color="red">Wikipedia</font></b></a>: "The two-sample KS test is one of the most useful and 
general nonparametric methods for comparing two samples, as it is sensitive 
to differences in both location and shape of the empirical cumulative 
distribution functions of the two samples."
<p>
<b>The null hypothesis is that both groups were sampled from populations 
with identical distributions. Hence, if the returned p-value is small
(eg, < 0.05), the two data sets were likely sampled from populations with 
different distributions and the null hypothesis can be rejected.</b> 
<p>
The <strong>kolsm2_n</strong> function does not test for 'ties'. This test
should only be used when ties are a very small percent of the entire samples. 
<p>
This function sorts the x and y subsets before doing the calculation.
As a result, large datasets will take time to perfom the required operations.
The original input arrays are not changed.  
<p>
<b>NOTE:</b> Any time a distribution (here, two distributions) is/are tested, the
user should realize that there is no substitute for large sample size(s). 
A minimum 'large' size would be at least 100 values.



</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
<a href="ftest.html"><strong>ftest</strong></a>, <a href="rtest.html"><strong>rtest</strong></a>, <a href="betainc.html"><strong>betainc</strong></a>
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<font color=red>See <a href="#V630_bug">note above</a> about bug with
multiple dimensions.</font><p>

<p>
As always, it is best if the sample sizes of <em>X</em> and <em>Y</em> are large.
<p>
<B>Example 1</B><p>
Consider two small arrays. 
<pre>
   x = (/15.7, 16.1, 15.9, 16.2, 15.9, 16.0, 15.8, 16.1, 16.3, 16.5, 15.5/)
   y = (/15.4, 16.0, 15.6, 15.7, 16.6, 16.3, 16.4, 16.8, 15.2, 16.9, 15.1/)

   p = <strong>kolsm2_n</strong>(x,y,0)     ; p=0.808 ; p@dstat = 0.2727; p@zstat= 0.639
                           ; can not reject null hypothesis (H0)
   print(p)

</pre>
The output from the print statement is:
<pre>

    Variable: p
    Type: float
    Total Size: 4 bytes
                1 values
    Number of Dimensions: 1
    Dimensions and sizes:   [1]
    Coordinates: 
    Number Of Attributes: 2
      dstat :       0.2727273
      zstat :       0.6396022
    (0)     0.8079244

<p>
The results match those obtained from <b>R</b>'s <b>ks.test</b>.
<pre>

   > a = c(15.7, 16.1, 15.9, 16.2, 15.9, 16.0, 15.8, 16.1, 16.3, 16.5, 15.5) 
   > b = c(15.4, 16.0, 15.6, 15.7, 16.6, 16.3, 16.4, 16.8, 15.2, 16.9, 15.1)
   > q = <b>ks.test</b>(a, b)
     Warning message:
     In ks.test(a, b) : cannot compute exact p-value with ties
   > q

	Two-sample Kolmogorov-Smirnov test

        data:  a and b
        D = 0.2727, p-value = 0.8079
        alternative hypothesis: two-sided
</pre>

<B>Example 2</B>
Let <em>X</em> and <em>Y</em> are one-dimensional arrays (they need
not be the same size). Note: the user may find some differences
from the results here due to the nature of the random number generators. 
<PRE> 

; two normal distributions

  NX   =  100
  xavg =  0.0
  xstd = 10.0

  NY   =  200
  yavg =  0.0
  ystd = 10.0

  X    = <a href="random_normal.html"><strong>random_normal</strong></a> (xavg, xstd, NX)
  Y    = <a href="random_normal.html"><strong>random_normal</strong></a> (yavg, ystd, NY)
  pXY  = <strong>kolsm2_n</strong>(X, Y, 0) ; pXY= 0.395 ; p@dstat= 0.11; p@zstat= 0.898
                                               ; <b>can not reject null hypothesis (H0) </b>

; two different distributions: normal and uniform 

  NZ   =  200
  zlow = -10.0
  zhi  =  10.0
  Z    = <a href="random_uniform.html"><strong>random_uniform</strong></a> (zlow, zhi, NZ)
  pXZ  = <strong>kolsm2_n</strong>(X, Z, 0)  ; pXZ=0.00 ; p@dstat = 0.265; p@zstat= 2.164
                                   ; <b>reject null hypothesis (H0)</b>
</PRE> 
<p>
The Example 2  X, Y, Z were saved to an ascii (text) file and then input to <b>R</b>'s <b>ks.test</b> function. The results matched.
<p>
<pre>
   > x = scan("../R_Data/xNormal.txt")
     Read 100 items
   > y = scan("../R_Data/yNormal.txt")
     Read 200 items
   
   > q = ks.test(x, y)
   > q
   
   	Two-sample Kolmogorov-Smirnov test
   
        data:  x and y
        D = 0.11, p-value = 0.3953
        alternative hypothesis: two-sided


   > u = scan("..//R_Data/yUniform.txt")
     Read 200 items
   > r = ks.test(x, u)
   > r

	Two-sample Kolmogorov-Smirnov test

        data:  x and u
        D = 0.265, p-value = 0.0001716
        alternative hypothesis: two-sided

</pre>
<p>

<B>Example 3</B><p>

<font color=red>See <a href="#V630_bug">note above</a> about bug with
multiple dimensions.</font><p>

Let <em>x</em>(ntim1,nlat1,mlon1) and  <em>y</em>(ntim2,nlat2,mlon2).

Are the distributions the same over the entire temporal and spatial domains?
Here, the user may explicitly set the dimensions or set to -1 or convert to one-dimensional arrays.
<pre>

    pxy  = <strong>kolsm2_n</strong>(x, y, (/0,1,2/)) ; Essentially, this makes one dimensional arrays for <em>x</em> and <em>y</em>.
                                            ; pxy, pxy@dstat, pxy@zstat
or

    pxy  = <strong>kolsm2_n</strong>(x, y,<b>-1</b>)

</pre>
<p>
<B>Example 4</B><p>

<font color=red>See <a href="#V630_bug">note above</a> about bug with
multiple dimensions.</font><p>

Let <em>x</em>(ntim1,nlat,mlon) and  <em>y</em>(ntim2,nlat,mlon). 
The 'ntim' may be different but the number of grid points must be the same.

<pre>
    pxy  = <strong>kolsm2_n</strong>(x, y, 0)  ; pxy(nlat,mlon); p@dstat(nlat,mlon); p@zstat(nlat,mlon)
</pre>

<p>
<B>Example 4</B><p>
Let <em>x</em>(ntim1,nlat,mlon) and  <em>y</em>(ntim2,nlat,mlon). 
The 'ntim' may be different but the number of grid points must be the same.

<pre>
    pxy  = <strong>kolsm2_n</strong>(x, y, 0)  ; pxy(nlat,mlon); p@dstat(nlat,mlon); p@zstat(nlat,mlon)
</pre>

<p>
<B>Example 5</B><p>
Let <em>x(N)</em> and <em>y(M)</em> possibly contain missing data 
(_FillValue).  Since <strong>kolsm2_n</strong> does not allow missing values, 
these must be removed by the user.

<pre>
    if (<a href="num.html"><strong>num</strong></a>(<a href="ismissing.html"><strong>ismissing</strong></a>(x)) .eq.0) then
        xx = x
    else
        xx = x(<a href="ind.html"><strong>ind</strong></a>(<a href="ismissing.html"><strong>ismissing</strong></a>(x)))   
    end if

    if (<a href="num.html"><strong>num</strong></a>(<a href="ismissing.html"><strong>ismissing</strong></a>(y)).eq.0) then
        yy = y
    else
        yy = y(<a href="ind.html"><strong>ind</strong></a>(<a href="ismissing.html"><strong>ismissing</strong></a>(y)))   
    end if

    pxy  = <strong>kolsm2_n</strong>(xx, yy, 0)  ; pxy; pxy@dstat; pxy@zstat

    <a href="delete.html"><strong>delete</strong></a>( [/xx,yy/] )   ; delete temporary arrays 
</pre>

<p>
<B>Example 6</B><p>
Let <em>x(K1,N,M)</em> and  <em>y(K2,N,M)</em> contain missing data 
(_FillValue).  Since <strong>kolsm2_n</strong> does not allow missing 
values, these must be removed by the user.

<pre>
    if (<a href="num.html"><strong>num</strong></a>(<a href="ismissing.html"><strong>ismissing</strong></a>(x)).eq.0) then
        xx   = x
    else
        x1d  = <a href="ndtooned.html"><strong>ndtooned</strong></a>(x)
        xx   = x1d(<a href="ind.html"><strong>ind</strong></a>(<a href="ismissing.html"><strong>ismissing</strong></a>(x1d)) )   
        <a href="delete.html"><strong>delete</strong></a>(x1d)
    end if

    if (<a href="num.html"><strong>num</strong></a>(<a href="ismissing.html"><strong>ismissing</strong></a>(y)).eq.0) then
        yy   = y
    else
        y1d  = <a href="ndtooned.html"><strong>ndtooned</strong></a>(y)
        yy   = x1d(<a href="ind.html"><strong>ind</strong></a>(<a href="ismissing.html"><strong>ismissing</strong></a>(x1d)) )   
        <a href="delete.html"><strong>delete</strong></a>(y1d)
    end if


    pxy  = <strong>kolsm2_n</strong>(xx, yy, 0)  ; pxy; pxy@dstat; pxy@zstat
    
    <a href="delete.html"><strong>delete</strong></a>( [/xx,yy/] )   ; delete temporary arrays 
</pre>

<p>
<B>Example 7</B><p>
Let <em>x(K1,N,M)</em> and <em>y(K2,N,M)</em> contain  
daily precipitation.  This introduces the possibility of many 
values equal to 0.0. Further, these arrays may contain missing values.
It is desired to test the distributions when it does precipitate.
<pre>

    x1d = <a href="ndtooned.html"><strong>ndtooned</strong></a>(x)
    ix  = <a href="ind.html"><strong>ind</strong></a>(.not.<a href="ismissing.html"><strong>ismissing</strong></a>(x1d) .and. x1d.gt.0.0) 

    y1d = <a href="ndtooned.html"><strong>ndtooned</strong></a>(y)
    iy  = <a href="ind.html"><strong>ind</strong></a>(.not.<a href="ismissing.html"><strong>ismissing</strong></a>(y1d) .and. y1d.gt.0.0) 

    pxy = <strong>kolsm2_n</strong>(x1d(ix), y1d(iy), 0)  ; pxy; pxy@dstat; pxy@zstat
    
    <a href="delete.html"><strong>delete</strong></a>( [/ix, iy/] )   ; delete temporary arrays
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/kolsm2_n.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:44 GMT -->
</html>
