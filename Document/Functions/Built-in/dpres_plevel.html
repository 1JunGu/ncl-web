<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/dpres_plevel.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:23 GMT -->
<head>
<meta name="description" content="NCL built-in functions (cesm)">
<meta name="keywords" content="dpres_plevel">
<title>dpres_plevel</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../meteo.html">Meteorology</a>,
<a class=crumb href="../cesm.html">CESM</a>
<br>
<h1>dpres_plevel</h1>

<p>
Calculates the pressure layer thicknesses of a constant pressure level coordinate system.
</p>

<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
	function dpres_plevel (
		plev [*] : numeric,  
		psfc     : numeric,  
		ptop [1] : numeric,  
		iopt     : integer   
	)

	<a href="../return_val.html">return_val</a>  :  numeric
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>plev</em>
<p class=indent>A one dimensional array containing the constant pressure levels. May be
in ascending or descending order. Must have the same units as <em>psfc</em>.
</p>
<em>psfc</em>
<p class=indent>A scalar or an array of up to three dimensions
containing the surface pressure data in Pa or hPa (mb). 
The rightmost dimensions must be latitude and longitude. 
Must have the same units as <em>plev</em>.
</p>
<em>ptop</em>
<p class=indent>A scalar specifying the top of the column.  <em>ptop</em> should be .le. <a href="min.html"><strong>min</strong></a>(plev).
Must have the same units as <em>plev</em>.
</p>
<em>iopt</em>
<p class=indent>Set to zero. Currently not used.
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
If <em>psfc</em> is a scalar the return variable will be
a one-dimensional array the same size as <em>plev</em>; 
if <em>psfc</em> is two-dimensional [e.g. (lat,lon)]
or three-dimensional [e.g. (time,lat,lon)] then the return
array will have an additional level dimension: (lev,lat,lon) or
(time,lev,lat,lon). The size of the lev dimension is 
the same as the size of <em>plev</em>. The returned type will be
double if <em>psfc</em> is double, float otherwise.
</p><a name="Description"></a>
<h2>Description</h2>
<p>
Calculates the layer pressure thickness of a constant pressure level system.  
It is analogous to <a href="dpres_hybrid_ccm.html"><strong>dpres_hybrid_ccm</strong></a> for hybrid coordinates.
At each grid point the sum of the pressure thicknesses equates to 
[<em>psfc</em>-<em>ptop</em>]. At each grid point,
the returned values above <em>ptop</em> and below <em>psfc</em>
will be set to <em>psfc</em>@_FillValue. If there is no 
<em>psfc</em>@_FillValue then the _FillValue will be set to 
the default for float or double (in V5.2.x and earlier, 1e20 is used).
If <em>ptop</em>
or <em>psfc</em> is between <em>plev</em> levels then the layer thickness  
is modifed accordingly. If <em>psfc</em> is set to _FillValue, all layer
thicknesses are set to the appropriate _FillValue.
<p>
The primary purpose of this function is to return
layer thicknesses to be used to weight observations
for integrations. 
<p>
Use the <a href="../Contributed/dpres_plevel_Wrap.html"><strong>dpres_plevel_Wrap</strong></a> function if metadata retention is desired.
The interface is identical.<p>

</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
<a href="../Contributed/dpres_plevel_Wrap.html"><strong>dpres_plevel_Wrap</strong></a>,
<a href="dpres_hybrid_ccm.html"><strong>dpres_hybrid_ccm</strong></a>,
<a href="dz_height.html"><strong>dz_height</strong></a>
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<b>Example 1</b> Consider a rawindsonde sounding and 
it is desired to compute the "internal energy"
which is an integrated quantity. 

<pre>
                             ; PRESSURE (hPa)
  plev = (/ 1000.,950.,900.,850.,800.,750.,700.,650.,600., \
             550.,500.,450.,400.,350.,300.,250.,200., \
             175.,150.,125.,100., 80., 70., 60., 50., \
              40., 30., 25., 20. /)

                             ; TEMPERATURE (C)   
  t    =(/29.3,28.1,23.5,20.9,18.4,15.9,13.1,10.1, 6.7, 3.1,   \
          -0.5,-4.5,-9.0,-14.8,-21.5,-29.7,-40.0,-52.4,   \
         -59.2,-66.5,-74.1,-78.5,-76.0,-71.6,-66.7,-61.3, \
         -56.3,-51.7,-50.7,-47.5 /)

  plev       = plev*100.        
  plev@units = "Pa"        ; Pa   =  kg/(m s2) (Pascal)

  t          = t+273.15         
  t@units    = "K"
         
  ptop       = <a href="min.html"><strong>min</strong></a>(plev)    

  psfc       = 1018*100.           
  psfc@units = "Pa" 

  dp   = <strong>dpres_plevel</strong>(plev, psfc, ptop, 0)  ; dp(30)

  ; Use <a href="../Contributed/dpres_plevel_Wrap.html"><strong>dpres_plevel_Wrap</strong></a> if metadata retention is desired
  ; dp   = <a href="../Contributed/dpres_plevel_Wrap.html"><strong>dpres_plevel_Wrap</strong></a>(plev, psfc, ptop, 0)  ; dp(30)

  <a href="print.html"><strong>print</strong></a>("dp="+dp+"    t="+t)

  CP = 1004.               ; J/(K kg)     [ m2/(K s2) ] 
  GR = 9.81                ; gravity      [ m/s2 ]
  
                           ; integrate vertically
  IE   = (CP/GR)*<a href="sum.html"><strong>sum</strong></a>( t*dp )  

  IE@long_name = "Internal Energy: Cp*sum( T*dp )/gravity"
  IE@units     = "kg/s2"
                           ; weighted vertical average
  IE_average   = IE/<a href="sum.html"><strong>sum</strong></a>(dp)  
  IE_average@long_name = "Internal Energy: Weighted vertical average"
</pre>
The output from the print statement is:
<pre>
        psfc=101800
(0)     plev=100000 dp=4300    t=302.45
(1)     plev=95000  dp=5000    t=301.25
(2)     plev=90000  dp=5000    t=296.65
(3)     plev=85000  dp=5000    t=294.05
(4)     plev=80000  dp=5000    t=291.55
(5)     plev=75000  dp=5000    t=289.05
(6)     plev=70000  dp=5000    t=286.25
(7)     plev=65000  dp=5000    t=283.25
(8)     plev=60000  dp=5000    t=279.85
(9)     plev=55000  dp=5000    t=276.25
(10)    plev=50000  dp=5000    t=272.65
(11)    plev=45000  dp=5000    t=268.65
(12)    plev=40000  dp=5000    t=264.15
(13)    plev=35000  dp=5000    t=258.35
(14)    plev=30000  dp=5000    t=251.65
(15)    plev=25000  dp=5000    t=243.45
(16)    plev=20000  dp=3750    t=233.15
(17)    plev=17500  dp=2500    t=220.75
(18)    plev=15000  dp=2500    t=213.95
(19)    plev=12500  dp=2500    t=206.65
(20)    plev=10000  dp=2250    t=199.05
(21)    plev=8000   dp=1500    t=194.65
(22)    plev=7000   dp=1000    t=197.15
(23)    plev=6000   dp=1000    t=201.55
(24)    plev=5000   dp=1000    t=206.45
(25)    plev=4000   dp=1000    t=211.85
(26)    plev=3000   dp=750     t=216.85
(27)    plev=2500   dp=500     t=221.45
(28)    plev=2000   dp=750     t=222.45
(29)    plev=1000   dp=500     t=225.65



Variable: IE
Type: float
Total Size: 4 bytes
            1 values
Number of Dimensions: 1
Dimensions and sizes:   [1]
Coordinates: 
Number Of Attributes: 2
  units :       W/m2
  long_name :   Internal Energy: Cp*sum( T*dp )/gravity
(0)     2.72987e+09
</pre>
<p>


<b>Example 2</b>
Consider a similar but more common usage. Read data from  
an ERA-40 (or NCEP) data set. Compute Latent heat energy.

<p>
<pre>
    f   = <a href="addfile.html"><strong>addfile</strong></a> ("foo.ERA40.nc" , "r")
    lev = f->lev  ; (/  1,  2,  3,  5,   7, 10, 20, 30, \
                  ;    50, 70,100,150, 200,250,300,400, \
                  ;   500,600,700,775, 850,925,1000 /)

    Q   = f->Q    ; kg/kg      (time,lev,lat,lon)
    psfc= f->PS   ; PA         (time,lat,lon)

    lev = lev*100
    lev@units = "Pa"    ; to match PS

    ptop= 0             ; integrate 0==>psfc at each grid point

                        ; dp(ntim,klev,nlat,mlon)
    dp  = <strong>dpres_plevel</strong>(lev, psfc, ptop, 0)

    ; Use <a href="../Contributed/dpres_plevel_Wrap.html"><strong>dpres_plevel_Wrap</strong></a> if metadata retention is desired
    ; dp  = <a href="../Contributed/dpres_plevel_Wrap.html"><strong>dpres_plevel_Wrap</strong></a>(lev, psfc, ptop, 0)

                        ; latent heat of vaporization at 0C
    L   = 2.5e6         ; J/kg         [ m2/s2 ]
    g   = 9.81          ; m/s


    Qdp = Q*dp          ; temporary variable               
    <a href="../Contributed/copy_VarCoords.html"><strong>copy_VarCoords</strong></a>(Q, Qdp)

                        ; integrate vertically [level dimension = 1]
    LE  = <a href="../Contributed/dim_sum_n_Wrap.html"><strong>dim_sum_n_Wrap</strong></a>( Qdp,1 )   ; LE(ntim,nlat,mlon)
    LE  = (L/GR)*LE     ; (time,lat,lon)
    LE@long_name = "Latent Energy:  SUM[L*Q*dp]/g"
    LE@units     = "kg/s2"

    <a href="printVarSummary.html"><strong>printVarSummary</strong></a>( LE )

    <a href="delete.html"><strong>delete</strong></a>( Qdp )    ; no longer needed
</pre>
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/dpres_plevel.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:23 GMT -->
</html>
