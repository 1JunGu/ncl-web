<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/kde_n_test.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:44 GMT -->
<head>
<meta name="description" content="NCL built-in functions (statistics)">
<meta name="keywords" content="kde_n_test">
<title>kde_n_test</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../math.html">General applied math</a>,
<a class=crumb href="../statistics.html">Statistics</a>
<br>
<h1>kde_n_test</h1>

<p>
Uses gaussian kernel density estimation (KDE) to estimate the probability density function of a random variable. <font color=red>This function is under construction and is available for testing only. It may not be released with NCL V6.5.0.</font>
</p>

<p>
<img src="https://www.ncl.ucar.edu/Images/new.gif"> <i>Available in <a href="../../../prev_releases.html#6.5.0">version 6.5.0</a> and later.</i>
<p>
<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
	function kde_n_test (
		x        : numeric,  
		bin  [*] : numeric,  
		dims [*] : integer   
	)

	<a href="../return_val.html">return_val</a>  :  float or double
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>x</em>
<p class=indent>A variable of any numeric type and any dimensionality. 
Missing values (i.e. <i>_FillValue</i>) are allowed but are ignored. 
The data are sorted internally.
</p>
<em>bin</em>
<p class=indent>User supplied, evenly-spaced band boundaries. One approach: 
<pre>
    bin = <a href="fspan.html"><strong>fspan</strong></a>(<a href="min.html"><strong>min</strong></a>(x), <a href="max.html"><strong>max</strong></a>(x), m)  ... m user specified
</pre>
</p>
<em>dims</em>
<p class=indent>The dimension(s) of <em>x</em> on which to calculate the KDE.
Must be consecutive and monotonically increasing.
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
Returns a variable of type float or double with dimensions <i>N</i> x <i>nbin</i>,
where <i>N</i> represents all but the <em>dims</em> dimensions of <em>x</em>,
and <i>nbin</i> is the length of <em>bin</em>. The returned
variable will have an attribute <em>band_width</em>.
</p><a name="Description"></a>
<h2>Description</h2>
<p>
<font color=red>This function is under construction and is available
for testing only. It may not be released with NCL V6.5.0.</font>
<p>

<a href="https://en.wikipedia.org/wiki/Kernel_density_estimation"><b>Kernel
Density Estimators (KDEs)</b></a> are a generalization and improvement
over histograms. A KDE is a non-parametric way to estimate the
probability density function of a random variable. Internally, a
specified density function (the kernel) is averaged across the
observed data points to create a smooth approximation. This function
uses a Gaussian kernel.
<p>

Technically, each <em>dims</em> dimension of <em>x</em> is an
independent and identically distributed sample drawn from some
distribution with an unknown probability distribution.
<p>

The returned <em>bandwidth</em> attribute represents the "plug-in"
derived bandwidth used to estimate the kernel density.  It is derived
assuming the underlying density being estimated is Gaussian.  Hence,
this approximation is termed the normal distribution approximation.
The returned bandwith is the ideal effective width of the sliding
window used to generate the density.
<p>

The code used was developed in the group of Theo Gasser by several 
people, mainly Walter Koehler, Alois Kneip and Eva Herrmann.
<p>
<b>References:</b>
<pre>
   T. Duong (2001): <a href="http://www.mvstat.net/tduong/research/seminars/seminar-2001-05/">An Introduction to Kernel Density Estimation</a>
   J. Engel, Eva Herrmann and Theo Gasser (1994): 

  <a href="http://dx.doi.org/10.1080/10485259408832598">An iterative bandwidth selector for kernel estimation of densities and their derivatives</a>. 
   Journal of Nonparametric Statistics 4,21-34.
   WIKIPEDIA: <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">Kernel Density Estimation</a>
   R: <a href="http://www.statmethods.net/graphs/density.html">Histograms and Density Plots</a>
</pre>

</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
<a href="../../../Applications/histo.html">Histograms</a>, 
<a href="../../../Applications/pdf.html">Probability Distribution Functions</a>,
<a href="../../../Applications/extreme_value.html">Extreme Value Statistics</a>
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<B>Example 1:</B> <p>
Read the <a href="../../../Applications/Data/asc/co2_R.txt"><b>CO2 data</b></a> 
used in an 
<a href="https://cran.r-project.org/web/packages/plugdensity/plugdensity.pdf"><b>R</b> example</a> 
and compute the KDE.
<pre>
  diri = "./"
  fili = "co2_R.txt"                             ; year  Jan Feb ....
  pthi = diri + fili
  ncol = 13

  DATA = <a href="../Contributed/readAsciiTable.html"><strong>readAsciiTable</strong></a>(pthi, ncol, "float", 1)  ; 39 x 13
  data = DATA(:,1:ncol-1)                        ; 39 x 12
  year = <a href="toint.html"><strong>toint</strong></a>(DATA(:,0))                         ; 39
  bin  = <a href="fspan.html"><strong>fspan</strong></a>(<a href="min.html"><strong>min</strong></a>(x), <a href="max.html"><strong>max</strong></a>(x), <b>20</b>)  ; <b>20</b> is arbitrary

  kde  = <strong>kde_n_test</strong>(data,bin,(/0,1/))
  <a href="print.html"><strong>print</strong></a>(kde)

  wks  = <a href="gsn_open_wks.html"><strong>gsn_open_wks</strong></a> ("png","KDE")               ; send graphics to PNG file
  plot = <a href="new.html"><strong>new</strong></a>(2,graphic)

; conventional histogram

  resh                         = True
  resh@gsnDraw                 = False
  resh@gsnFrame                = False
  resh@tmXBLabelStride          = 2
  resh@gsnHistogramNumberOfBins = m
  resh@tiMainString    = "CO2: N="+nx+"  nBands="+resh@gsnHistogramNumberOfBins
  plot(0) = <a href="../../Graphics/Interfaces/gsn_histogram.html"><strong>gsn_histogram</strong></a>(wks,x,resh)         ; create histogram with 20 bins

; KDE

  res              = True
  res@gsnDraw      = False
  res@gsnFrame     = False
  res@tiMainString = "KDE: kde: m="+m
  plot(1) = <a href="../../Graphics/Interfaces/gsn_csm_xy.html"><strong>gsn_csm_xy</strong></a> (wks,bin,kde,res) ; create plot

  resP = True
  resP@gsnMaximize = True
  <a href="../../Graphics/Interfaces/gsn_panel.html"><strong>gsn_panel</strong></a>(wks,plot,(/2,1/),resP)

</pre>
The following is the printed output. The png which illustrate the raw histogram and
the KDE  is <a href="../Images/KDE.png"><b>here</b> </a>:
<pre>
     
     Variable: kde
     Type: float
     Total Size: 160 bytes
                  20 values
     Number of Dimensions: 1
     Dimensions and sizes:	[20]
     Coordinates: 
     Number Of Attributes: 2
         <b>band_width</b>:  2.7646584
        _FillValue :	-999
     (0)	0.008310404637906145
     (1)	0.01892484197867318
     (2)	0.02660068622809162
     (3)	0.02729265814591201
     (4)	0.0246401406934126
     (5)	0.02266077616486179
     (6)	0.0209884990313704
     (7)	0.0192692604053928
     (8)	0.01796419445641813
     (9)	0.0173405514578292
     (10)	0.01704959661657353
     (11)	0.01659004328256386
     (12)	0.01584238726767876
     (13)	0.01593767187451854
     (14)	0.01746199347070328
     (15)	0.01831172649388734
     (16)	0.01715100099909148
     (17)	0.01418628346503685
     (18)	0.009595145734716143
     (19)	0.004485370717108967
</pre>

</example>
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/kde_n_test.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:44 GMT -->
</html>
