<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/prcwater_dp.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:19:04 GMT -->
<head>
<meta name="description" content="NCL built-in functions (meteorology)">
<meta name="keywords" content="prcwater_dp">
<title>prcwater_dp</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../meteo.html">Meteorology</a>
<br>
<h1>prcwater_dp</h1>

<p>
Computes total column precipitable water of the rightmost dimension.
</p>

<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
	function prcwater_dp (
		q  : numeric,  
		p  : numeric   
	)

	<a href="../return_val.html">return_val</a>  :  numeric
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>q</em>
<p class=indent>An array of any dimensionality or a scalar value equal to the specific humidity 
in kg/kg.  The rightmost dimension must be the level dimension.
</p>
<em>p</em>
<p class=indent>An array of the same size as <em>q</em> or a one-dimensional array with only a
level dimension equal to the pressure layer thickness in <b>Pa</b>.
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
An array of the same size as <em>q</em> minus the rightmost dimension. Units are kg/m2.
</p><a name="Description"></a>
<h2>Description</h2>
<p>
Computes total column precipitable water of the rightmost dimension.
<p>
<b>Background:</b>
This function was one of the original suite of meteorological functions. 
For historical reasons these original NCL functions operated upon the rightmost 
dimension for efficiency. Often, this required that the input variables be
reordered via <a href="../../Language/reorder.html">
<b>dimension reordering</b>. This can be a nuisance and lead to cumbersome code.
An adventage of <strong>prcwater_dp</strong> is that the <em>dp</em> 
can be one-dimensional [*].
<p>
Example 4 shows another approach to calculating total precipitable water.

</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
<a href="dpres_plevel.html"><strong>dpres_plevel</strong></a>,
<a href="dpres_hybrid_ccm.html"><strong>dpres_hybrid_ccm</strong></a>,
<a href="../Contributed/dpres_plevel_Wrap.html"><strong>dpres_plevel_Wrap</strong></a>,
<a href="dim_sum_n.html"><strong>dim_sum_n</strong></a>,
<a href="../Contributed/dim_sum_n_Wrap.html"><strong>dim_sum_n_Wrap</strong></a>,
<a href="confirm_dims.html"><strong>confirm_dims</strong></a>, <a href="confirm.html"><strong>confirm</strong></a>
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<p>
<B>Example 1</B> 
<p>
Let q and dp be one-dimensional. No dimension reordering is necessary. 
Units must be converted to those expected.
The calculated 'pw' will be a scalar. Attributes are added
for completeness.

<PRE>
  dp = (/ 10., 30. , 50., ..., 100., 50., 50, 50./)   ; hPa [mb]
  q  = (/ 20.8,19.4,16.5, ..., 1.7,1.0,0.5,0.1   /)   ; g/kg
 
  dp = dp*100.   ; convert hPa to pascals
  q  = q*0.001   ; convert g/kg to kg/kg
  
  pw = <strong>prcwater_dp</strong> (q,dp)          ; pw [kg/m2]
  pw@long_name = "total column precipitable water"
  pw@units     = "kg/m2"
</PRE>
<P>

<B>Example 2</B>
<p>
Let q be four-dimensional with named dimensions: q(time,<b>lev</b>,lat,lon). 
<a href="../../Language/reorder.html">Reorder</a> the
array so that <b>lev</b> is the rightmost dimension. The units are g/kg.
The must be converted to (kg/kg). Hence the conversion factor.
dp is one-dimensional with units of pascals (Pa).  pw will be three-dimensional
with dimensions time,lat,lon. The same dp is used at all locations.
Add meta data (attributes and coordinate information).

<PRE>
  cf = 0.001                ; convert g/kg to kg/kg
  pw = <strong>prcwater_dp</strong> (q(time|:,lat|:,lon|:,<b>lev|:</b>)*cf, dp)
  pw@long_name = "total column precipitable water"
  pw@units     = "kg/m2"
           
  <a href="../Contributed/copy_VarCoords.html"><strong>copy_VarCoords</strong></a>(q(time,0,lat,lon), pw) ; add coordinate information
  <a href="printVarSummary.html"><strong>printVarSummary</strong></a>(pw)     ; pw(time,lat,lon)
</PRE>
<P>

<B>Example 3:</B>
<p>
Let q(time,lev,lat,lon) with units (kg/kg).  
dp (Pa) is calculated from the hybrid coefficients using <a href="dpres_hybrid_ccm.html"><strong>dpres_hybrid_ccm</strong></a>.  
Different layer thicknesses are used at each grid point. 
This example uses dimension reordering.
<PRE>
  q    = f->Q    ; specific humidity [kg/kg];  (time,lev,lat,lon)
                 ;                             (ntim,<b>klev</b>,nlat,mlon)
  hyai = f->hyai ; interface hybrid coefficients; <b>klevi= klev+1</b>
  hybi = f->hybi ;  
  ps   = f->PS   ; surface pressure [Pa]      ; (time,lat,lon)
  p0   = 100000. ; since ps is in Pa 
       
  dp   = <a href="dpres_hybrid_ccm.html"><strong>dpres_hybrid_ccm</strong></a>(ps,p0,hyai,hybi)   ; dp(ntime,<b>klevi-1</b>,nlat,nlon)
  <a href="../Contributed/copy_VarCoords.html"><strong>copy_VarCoords</strong></a>(q,dp)    ; dp(time,<b>lev</b>,lat,lon)

  pw = <strong>prcwater_dp</strong>(q(time|:,lat|:,lon|:,<b>lev|:</b>),dp(time|:,lat|:,lon|:,<b>lev|:</b>))    
  pw@long_name = "total column precipitable water"
  pw@units     = "kg/m2"
</PRE>

<B>Example 4:</B> 
<p>
This illustrates another approach to calculating total precipitable water.
It illustrates a step-by-step procedure with code documentation using attributes. 
Dimension reordering is <b>not</b> used.
<PRE>

  diri = "./"
  fili = "camaqua.cam2.h1.1985-09-01-00000.nc"
  pthi = diri+fili
  f    = <a href="addfile.html"><strong>addfile</strong></a>(pthi, "r")

  q    = f->Q    ; specific humidity [kg/kg]: (time,lev , lat, lon)
                 ;                            (ntim,klev,nlat,mlon) ; dimension sizes
                 ;                            ( 0    1     2    3 ) ; dimension numbers
  hyai = f->hyai ; interface hybrid coefficients (klevi = klev+1)
  hybi = f->hybi

  ps   = f->PS   ; surface pressure [Pa]: (time,lat,lon)
  p0   = 100000. ; since ps is in Pa 

  dp   = <a href="dpres_hybrid_ccm.html"><strong>dpres_hybrid_ccm</strong></a>(ps,p0,hyai,hybi)    ; (ntim,klev,nlat,mlon): no meta data
                                               ; <b>for clarity</b>; add meta data; not necessary
  <a href="../Contributed/copy_VarCoords.html"><strong>copy_VarCoords</strong></a>(q,dp)                        ; add coordinate info (time,lev,lat,lon)
  dp@long_name = "hybrid layer thickness"      ; add attributes
  dp@units     = ps@units   

  qdp  = q*dp                                  ; (ntim,<b>klev</b>,nlat,mlon): no meta data
  <a href="../Contributed/copy_VarCoords.html"><strong>copy_VarCoords</strong></a>(q,qdp)                       ; <b>for clarity</b>; add meta data; not necessary
  qdp@long_name = "q*dp"
 ;qdp@units     = "(kg/kg) Pa"                 ; since Pa=[kg/(m-s2)] 
  qdp@units     = "kg/m-s2"                    ; (kg/kg)  [kg/(m-s2)]" => "kg/m-s2"

  g   = 9.80665                                ; [m/s2] gravity at 45 deg lat used by the WMO
  qdp = qdp/g                                  ; [kg/m-s2]/[m/s2] => kg/m2
  qdp@units = "mm"                             ; [kg/m2][1000 mm/m][(1/1000) m3/kg] ==> mm

  pw = <a href="../Contributed/dim_sum_n_Wrap.html"><strong>dim_sum_n_Wrap</strong></a>(qdp, <b>1</b>)                ; (time,lat,lon)                 
  pw@long_name = "total column precipitable water"
  pw@units     = "mm"

  <a href="printVarSummary.html"><strong>printVarSummary</strong></a>(pw)       
  <a href="printMinMax.html"><strong>printMinMax</strong></a>(pw,0)
  print("---")

</PRE>
The output will be:
<pre>
  
  Variable: pw
  Type: float
  Total Size: 983040 bytes
              245760 values
  Number of Dimensions: 3
  Dimensions and sizes:	[time | 30] x [lat | 64] x [lon | 128]
  Coordinates: 
              time: [   0..  29]
              lat: [-87.86379883923262..87.86379883923262]
              lon: [   0..357.1875]
  Number Of Attributes: 3
    long_name :<b>total column precipitable water</b>
    units : <b>mm</b>
    sum_op_ncl :	dim_sum_n over dimension(s): lev
  
  (0)	total column precipitable water: <b>min=0.0811549   max=101.736</b>

</pre>
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/prcwater_dp.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:19:04 GMT -->
</html>
