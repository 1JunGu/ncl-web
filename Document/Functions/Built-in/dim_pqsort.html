<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/dim_pqsort.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:22 GMT -->
<head>
<meta name="description" content="NCL built-in functions (general applied math)">
<meta name="keywords" content="dim_pqsort">
<title>dim_pqsort</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../math.html">General applied math</a>
<br>
<h1>dim_pqsort</h1>

<p>
Computes the permutation vector generated by sorting the <I>n</I> - 1th
(rightmost) dimension.
</p>

<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
	function dim_pqsort (
		x      : integer, float or double,  
		kflag  : integer                    
	)

	<a href="../return_val.html">return_val</a> [<a href="dimsizes.html"><strong>dimsizes</strong></a>(x)] :  integer
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>x</em>
<p class=indent>An integer, float, or double array of any dimensionality
</p>
<em>kflag</em>
<p class=indent><UL>

<LI>2 - return the permutation vector resulting from sorting <em>x</em>
in increasing order and sort <em>x</em> also.

<LI>1 - return the permutation vector resulting from sorting <em>x</em>
in increasing order and do not sort <em>x</em>.

<LI>-1 - return the permutation vector resulting from sorting <em>x</em>
in decreasing order and do not sort <em>x</em>.

<LI>-2 - return the permutation vector resulting from sorting <em>x</em>
in decreasing order and sort <em>x</em> also.

</UL>
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
Returns an integer array dimensioned the same size as <em>x</em>.
</p><a name="Description"></a>
<h2>Description</h2>
<p>
This function returns the permutation array generated by sorting the
rightmost (<I>n</I> - 1th) dimension of the <em>x</em> array and,
optionally, rearranging the elements of the array.  The array will be
sorted in increasing or decreasing order.  A slightly modified
quicksort algorithm is used.<P>

Ignoring <a href="../../Language/fillval.html">
missing values</a> is not supported; they are sorted to either end
of the array based on their actual value.<P>

The output permutation array will be the index of the value in the
original order of the <em>x</em> array; that is, in the <I>i</I>-th
location in the sorted order.<P>

Use <a href="dim_pqsort_n.html"><strong>dim_pqsort_n</strong></a> if you want to specify which
dimension to do the average across.
<p>


</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
<a href="dim_pqsort_n.html"><strong>dim_pqsort_n</strong></a>,
<a href="qsort.html"><strong>qsort</strong></a>,
<a href="sqsort.html"><strong>sqsort</strong></a>
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<B>Example 1</B><P>

Let x be an array of length ntim. Generate a permutation vector in 

<UL>
<LI>ascending order, do not sort x:<br>
      <PRE>ip = <strong>dim_pqsort</strong>(x, 1)</PRE><BR>
<LI>descending order, do not sort x:<br>
      <PRE>ip = <strong>dim_pqsort</strong>(x, -1)</PRE><BR>
<LI>ascending order, sort x also: <br>
      <PRE>ip = <strong>dim_pqsort</strong>(x, 2)</PRE><BR>
<LI>descending order, sort x also: <br>
      <PRE>ip = <strong>dim_pqsort</strong>(x, -2)</PRE><BR> 
</UL>

<B>Example 2</B><P>

Define ip = <strong>dim_pqsort</strong>(x, 1) (ascending order, do not sort x)

and it is desired to reorder a different array (say, y) using the permutation vector
associated with x.  Assume y(ntim, nlat, mlon) with named dimensions and
coordinate variables "time", "lat" and "lon". Then:
 
<PRE>
  y2 = y                ; create y2 with attribute, coordinate values
  y2 = y(ip, :, :)      ; y2 will contain the values of "y"
                        ; rearranged according to the permutation
                        ; vector associated with x. 
  y2&time = y&time(ip)  ; reorder the time coordinate variable
</PRE>

<B>Example 3</B><P>

Define x(ntim, nlat, mlon) with named dimensions "time","lat", "lon".  Then:

<PRE>
  ip = <strong>dim_pqsort</strong>(x(lat|:, lon|:, time|:), 1) ; ===> ip(nlat, mlon, ntim)

  ip = <a href="dim_pqsort_n.html"><strong>dim_pqsort_n</strong></a>(x, 1, 0)                  ; no reordering needed
</PRE>

Note: you need to be careful about reordering your array in the call
to this function. As long as you don't want the function to reorder
the original array itself, you should be okay.
<p>

However, if you want the original array reordered, you will need to
reorder the array and save it to a temporary variable, pass this
temporary variable to the function, and then reorder the temporary
variable again.
<p>

<PRE>
  xtmp = x(lat|:, lon|:, time|:)
  ip   = <strong>dim_pqsort</strong>(xtmp, 2) ; ===> ip(nlat, mlon, ntim)
  x    = xtmp(time|:, lat|:, lon|:)
</PRE>
<p>

Or, preferably, just use <a href="dim_pqsort_n.html"><strong>dim_pqsort_n</strong></a>:
<p>

<PRE>
  ip = <a href="dim_pqsort_n.html"><strong>dim_pqsort_n</strong></a>(x, 2, 0)                  ; no reordering needed
</PRE>

<B>Example 4</B><p>
Generate 1000 series of length 30 with unique ordering.

<PRE>
  <a href="random_setallseed.html"><strong>random_setallseed</strong></a>(363738674, 918273645)   ; Set seeds (NOT required)

  nvals = 30
  narr  = 1000

;---Generate 1000 x 30 random numbers
  r = <a href="random_uniform.html"><strong>random_uniform</strong></a>(0,1,(/narr,nvals/))  ; random numbers

;---Sorting the values and keeping the indexes gives us random indexes.
  indexes = <strong>dim_pqsort</strong>(r, 1)             ; <b>use in 30 element segments</b
>

;--- concise print for illustration
  do i=0,narr-1
    str = ""
    do j=0,nvals-1
      str = str + " " + indexes(i,j)
    end do
    <a href="print.html"><strong>print</strong></a>("" + str)
  end do
</PRE>

Sample 'indexes'

<pre>
(0)      15 16 22 18 23 5 21 12 3 17 0 1 8 11 9 4 20 25 28 2 13 6 27 24 19 26 14 7 29 10
(0)      1 7 25 9 21 29 8 14 20 11 16 4 5 22 19 23 12 0 27 18 28 24 15 13 26 3 6 17 2 10
(0)      14 29 4 20 18 22 27 3 24 25 0 9 28 12 6 7 1 15 26 10 23 5 21 19 13 11 17 8 2 16
(0)      28 27 1 10 2 0 5 23 4 21 18 17 22 29 13 16 11 26 6 24 15 9 19 14 25 20 3 7 12 8
(0)      20 2 12 11 22 17 25 19 15 4 16 6 18 23 9 13 8 1 27 29 5 28 3 0 14 21 7 24 26 10
(0)      4 15 25 8 10 28 16 21 26 0 14 6 27 24 18 22 7 2 13 17 11 23 9 5 19 20 29 3 12 1
(0)      2 7 0 28 10 26 24 19 13 20 29 25 17 14 23 18 27 6 3 5 1 21 16 4 15 9 22 11 12 8
(0)      17 15 11 24 27 12 14 1 22 6 9 21 5 0 29 28 23 13 3 16 25 8 26 2 20 4 19 10 18 7
(0)      3 15 27 2 6 21 17 28 16 11 18 26 13 9 24 19 5 8 12 14 7 1 20 25 23 22 0 29 10 4
[SNIP]
</pre>
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/dim_pqsort.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:22 GMT -->
</html>
