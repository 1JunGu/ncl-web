<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
	<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/eofunc_ts.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:27 GMT -->
<head>
<meta name="description" content="NCL built-in functions (empirical orthogonal functions)">
<meta name="keywords" content="eofunc_ts">
<title>eofunc_ts</title>
</head>

<body>
	
	<!-- main navigation include -->
		<!-- NCL CSS -->
	<link rel="stylesheet" href="../../../styles/ncl.css" type="text/css" media="all">
	
	
		<!-- Equal Height Columns -->
		<script type="text/javascript" src="../../../scripts/column_height_equal.js"></script>
		
		<!-- DOJO Expandable Tree Nav -->

		<script type="text/javascript" src="../../../scripts/dojo/dojo.js"></script>
		<script type="text/javascript">
		
		dojo.require("dojo.widget.TreeV3");
		dojo.require("dojo.widget.TreeNodeV3");
		dojo.require("dojo.widget.TreeLinkExtension");
		dojo.require("dojo.widget.TreeBasicControllerV3");
		dojo.hostenv.writeIncludes();

		</script>
		

		<div id="top_colorbar"><!-- begin top_colorbar -->
		</div><!-- end top_colorbar -->


	<div id="nav_org_wrap"><!-- begin nav_org_wrap -->
	<div id="nav_org"><!-- begin nav_org -->

		<ul class="menubar">


			<li><a class="trigger" href="../../../internal/index.html">&nbsp;</a>
			</li>

			<li><a class="trigger" href="http://www.ucar.edu/">UCAR</a>
			</li>

			<li><a class="trigger" href="http://www.ncar.ucar.edu/">NCAR</a>
			</li>

			<li><a class="trigger" href="http://www.cisl.ucar.edu/">CISL</a>
			</li>
		</ul>

	</div><!-- end nav_org -->

	<div id="search"><!-- begin search -->

		<ul class="menubar">

			<li><a class="trigger" href="../../../Download/index.html">Download</a>
			</li>

			<li><a class="trigger" href="../../../citation.html">Citing NCL</a>
			</li>

			<li><a class="trigger" href="../../../contributors.html">Contributors</a>
			</li>

		</ul>

	</div><!-- end search -->

	</div><!-- end nav_org_wrap -->
	
	
	

		<div id="nav_main_wrap"><!-- begin nav_main_wrap -->

		<div id="nav_main"><!-- begin nav_main -->
			<ul id="menubar_main">

				<li>
				<a href="../../Pivot_to_Python/september_2019_update.html" class="triggeryw">&#9733; UPDATED LETTER TO NCL USERS</a>
				<li>
				<a href="../../../index.html" class="triggeron">NCL</a>
					<ul>
                                          <li><a href="../../Pivot_to_Python/index.html">Pivot to Python</a>
					  <li><a href="../../../overview.html" class="subitem">Overview</a></li>
						<li><a href="../../../get_started.html" class="subitem">Getting Started</a> </li>
						<li><a href="../../../gallery.html" class="subitem">Gallery</a></li>
						<li><a href="../../../Download/index.html" class="subitem">Download</a></li>
						<li><a href="../../../current_release.html" class="subitem">What's New</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>						
						<li><a href="../../../citation.html" class="subitem">Citing NCL</a></li>
					</ul>

				</li>

				<li>
				<a href="../../../Applications/index.html" class="trigger">Examples</a>
					<ul>
						<li><a href="../../../Applications/index.html" class="subitem" title="Examples">All Examples</a></li>
						<li><a href="../../../Applications/Templates/index.html" class="subitem">Templates</a></li>
						<li><a href="../../../Applications/list_io.html" class="subitem">File I/O</a></li>
						<li><a href="../../../Applications/list_data.html" class="subitem">Datasets</a></li>
						<li><a href="../../../Applications/list_maps.html" class="subitem">Maps</a></li>
						<li><a href="../../../Applications/list_models.html" class="subitem">Models</a></li>
						<li><a href="../../../Applications/list_dataP.html" class="subitem">Data Analysis</a></li>
						<li><a href="../../../Applications/list_ptypes.html" class="subitem">Plot Types</a></li>
						<li><a href="../../../Applications/list_tech.html" class="subitem">Plot Techniques</a></li>
						<li><a href="../../../Applications/list_special.html" class="subitem">Special Plots</a></li>
						<li><a href="../../../Applications/list_grids.html" class="subitem">Non-uniform Grids</a></li>
						<li><a href="../../../Applications/list_misc.html" class="subitem">Miscellaneous</a></li>
					</ul>
				</li>

				<li>
				<a href="../list_alpha.html" class="trigger">Functions</a>
					<ul>
						<li><a href="../list_alpha.html" class="subitem">Alphabetical Listing</a></li>
						<li><a href="../index.html" class="subitem">Category Listing</a></li>
						<li><a href="../list_type.html" class="subitem">Function-Type Listing</a></li>						
					</ul>
				</li>
				
				<li>
				<a href="../../Graphics/Resources/index.html" class="trigger">Resources</a>
					<ul>
					  <li><a href="../../Graphics/Resources/list_alpha_res.html" class="subitem">Complete Listing</a></li>
					
						<li><a href="../../Graphics/Resources/am.html" class="subitem">am (annotation manager)</a></li>
						<li><a href="../../Graphics/Resources/app.html" class="subitem">app (app)</a></li>
						<li><a href="../../Graphics/Resources/ca.html" class="subitem">ca (coordinate array)</a></li>
						<li><a href="../../Graphics/Resources/cn.html" class="subitem">cn (contour)</a></li>
						<li><a href="../../Graphics/Resources/ct.html" class="subitem">ct (coordinate array table)</a></li>
						<li><a href="../../Graphics/Resources/dc.html" class="subitem">dc (data comm)</a></li>
						
						<li><a href="../../Graphics/Resources/err.html" class="subitem">err (error)</a></li>
						<li><a href="../../Graphics/Resources/gs.html" class="subitem">gs (graphics styles)</a></li>
						<li><a href="../../Graphics/Resources/gsn.html" class="subitem">gsn (gsn high-level interfaces)</a></li>
						<li><a href="../../Graphics/Resources/lb.html" class="subitem">lb (label bar)</a></li>
						<li><a href="../../Graphics/Resources/lg.html" class="subitem">lg (legends)</a></li>
						<li><a href="../../Graphics/Resources/mp.html" class="subitem">mp (maps)</a></li>
						
						<li><a href="../../Graphics/Resources/pm.html" class="subitem">pm (plot manager)</a></li>
						<li><a href="../../Graphics/Resources/pr.html" class="subitem">pr (primitives)</a></li>
						<li><a href="../../Graphics/Resources/sf.html" class="subitem">sf (scalar field)</a></li>
						<li><a href="../../Graphics/Resources/st.html" class="subitem">st (streamline)</a></li>
						<li><a href="../../Graphics/Resources/tf.html" class="subitem">tf (transform)</a></li>
						<li><a href="../../Graphics/Resources/ti.html" class="subitem">ti (title)</a></li>
						
						<li><a href="../../Graphics/Resources/tm.html" class="subitem">tm (tickmark)</a></li>
						<li><a href="../../Graphics/Resources/tr.html" class="subitem">tr (transformation)</a></li>
						<li><a href="../../Graphics/Resources/tx.html" class="subitem">tx (text)</a></li>
						<li><a href="../../Graphics/Resources/vc.html" class="subitem">vc (vectors)</a></li>
						<li><a href="../../Graphics/Resources/vf.html" class="subitem">vf (vector field)</a></li>
						<li><a href="../../Graphics/Resources/vp.html" class="subitem">vp (view port)</a></li>
						
						<li><a href="../../Graphics/Resources/wk.html" class="subitem">wk (workstation)</a></li>
						<li><a href="../../Graphics/Resources/ws.html" class="subitem">ws (workspace)</a></li>
						<li><a href="../../Graphics/Resources/xy.html" class="subitem">xy (xy plots)</a></li>						
					</ul>
        </li>

				<li>
				<a href="../../../links.html" class="trigger">Popular Links</a>
					<ul>
					<li><a href="../../Graphics/hlures.html" class="subitem">.hluresfile</a></li>
					<li><a href="../../Graphics/color_table_gallery.html" class="subitem">Color Tables</a></li>
					<li><a href="../../Graphics/font_tables.html" class="subitem">Font Tables</a></li>	
					<li><a href="../../Language/error_messages.html" class="subitem">Error Messages</a></li>	
					<li><a href="../../Graphics/Images/dashpatterns.png" class="subitem">Dash Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/fillpatterns.png" class="subitem">Fill Pattern Table</a></li>	
					<li><a href="../../Graphics/Images/markers.png" class="subitem">Marker Table</a></li>
					<li><a href="../../Graphics/map_projections.html" class="subitem">Map Projections</a></li>
					<li><a href="../../Graphics/rangs.html" class="subitem">High Resolution Map Database</a></li>
					<li><a href="../../../Applications/editor.html" class="subitem">Editor Enhancements</a></li>
					<li><a href="../../Tools/ncl_convert2nc.html">ncl_convert2nc</a></li>
					<li><a href="../../Tools/ncl_filedump.html">ncl_filedump</a></li>
					<li><a href="../../Tools/index.html" class="subitem">Tools</a></li>
					<li><a href="../../Tools/WRAPIT.html" class="subitem">WRAPIT</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../announcements.html" class="trigger">What's New</a>
					<ul>
					        <li><a href="../../../announcements.html" class="subitem">Announcements</a></li>
						<li><a href="../../../current_release.html" class="subitem">In Latest Release</a></li>
						<li><a href="../../../new_applications.html" class="subitem">In Application Examples</a></li>
						<li><a href="../../../future_release.html" class="subitem">In Next Release</a></li>	
						<li><a href="../../../prev_releases.html" class="subitem">In Previous Releases</a></li>
					</ul>
				</li>
	

				<li>
				<a href="../../../Support/index.html" class='trigger'>Support</a>
					<ul>
						<li><a href="../../../Support/email_lists.html" class="subitem">Email Lists</a></li>
						<li><a href="../../../Applications/editor.html" class="subitem">Editor enhancements</a></li>
						<li><a href="../../Language/error_messages.html" class="subitem">Error messages</a></li>
						<li><a href="../../Manuals/index.html" class="subitem">Manuals</a></li>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="../../../Training/index.html" class="subitem">Training</a></li>
						<li><a href="../../../Training/Webinars/index.html" class="subitem">Webinars</a></li>
						<li><a href="../../../Training/Workshops/index.html" class="subitem">Workshops</a></li>
						<li><a href="../../index.html" class="subitem">Documentation</a></li>
						<li><a href="../../../FAQ/index.html" class="subitem">FAQ</a></li>
						<li><a href="../../../ftp_files.html" class="subitem">Uploading files via ftp</a></li>
						<li><a href="../../../report_bug.html" class="subitem">Report Bugs</a></li>
					</ul>
				</li>

				<li>
				<a href="../../../External/index.html" class='trigger'>External</a>
					<ul>
						<li><a href="https://www2.cisl.ucar.edu/resources/computational-systems/geyser-and-caldera/visualization/using-ncl-the-cheyenne-environment">NCL on Cheyenne</a>
						<li><a href="http://climatedataguide.ucar.edu/" class="subitem">Climate Data Guide</a></li>
						<li><a href="https://code.zmaw.de/projects/cdo/" class="subitem">Climate Data Operators</a></li>
						<li><a href="http://www.earthsystemmodeling.org/" class="subitem">Earth System Modeling Framework</a></li>
						<li><a href="http://nco.sourceforge.net/" class="subitem">NetCDF Operators</a></li>
						<li><a href="http://www.pyngl.ucar.edu/" class="subitem">PyNGL</a></li>
						<li><a href="http://www.pyngl.ucar.edu/Nio.shtml" class="subitem">PyNIO</a></li>
					</ul>
				</li>


			<!-- end menubar_main -->		
			</ul>
		
		<!-- end nav_main -->	
		</div>
		
	<!-- end nav_main_wrap -->	
  	</div>
		
			

	
	<div id="wrap"><!-- begin wrap -->
	<div id="content"><!-- begin content -->
	
	<!-- ######### BEGIN EDITABLE PAGE CONTENT ######### -->

			<div id="subheader"><!-- begin subheader -->
			<map name="ncl-home">
<area shape="rect" coords="0,0,65,40" href="../../../index-2.html">
<area shape="rect" coords="540,0,615,40" href="http://www.ncar.ucar.edu/">
<area shape="rect" coords="625,0,665,40" href="http://www.nsf.gov/">
</map>

	<div id="nclheader">
	<img src="https://www.ncl.ucar.edu/Images/NCL_NCAR_NSF_banner.png" height=40 "NCL Website header" usemap="#ncl-home">
	</div>


			<div id="googlesearch">
<form style="float:right" id="cse-search-box" action="http://google.com/cse">
  <input type="hidden" name="cx" value="016712339613867830978:igijo92w2zo" />
  <input type="hidden" name="ie" value="UTF-8" />
  <input type="text" name="q" size="31" maxlength="255" id="searchbox" /><label for="searchbox">Search</label>
  <input type="hidden" name="hq" value="site:www.ncl.ucar.edu">
</form>
			</div><!-- end googlesearch -->

			</div><!-- end subheader -->
			
			      <div id="general_main">
<a class=crumb href="../../../index-2.html">NCL Home ></a>
<a class=crumb href="../../index-2.html">Documentation ></a>
<a class=crumb href="../index-2.html">Functions ></a>
<a class=crumb href="../eofs.html">Empirical orthogonal functions</a>
<br>
<h1>eofunc_ts</h1>

<p>
Calculates the time series of the amplitudes associated with each
eigenvalue in an EOF.
</p>

<a name="Prototype"></a>
<h2>Prototype</h2>
<pre>
	function eofunc_ts (
		data    : numeric,  
		evec    : numeric,  
		optETS  : logical   
	)

	<a href="../return_val.html">return_val</a>  :  numeric
</pre>
<a name="Arguments"></a>
<h2>Arguments</h2>
<em>data</em>
<p class=indent>A multi-dimensional array in which the rightmost dimension is the number of 
observations. Generally, this is the time dimension. 
</p>
<p class=indent>

If your rightmost dimension is not time, then see
<a href="eofunc_ts_n.html"><strong>eofunc_ts_n</strong></a>.
</p>
<em>evec</em>
<p class=indent>A multi-dimensional array containing the EOFs calculated using 
<a href="eofunc.html"><strong>eofunc</strong></a>.
</p>
<em>optETS</em>
<p class=indent>A logical variable to which various optional arguments may be assigned as 
<a href="../../Language/attributes.html">attributes</a>.
These optional arguments alter the default behavior of the function.
Must be set to True prior to setting the 
<a href="../../Language/attributes.html">attributes</a> which
are assigned using the @ operator:

<UL>
<LI><I>jopt</I> - integer (default is 0)</p>
<p class=indent>
<pre>
optETS      = True
optETS@jopt = 1
</pre>

optETS@jopt = 1: Use the standardized data matrix to compute the time series.
The default is to use <em>data</em> and <em>evec</em>.</li>
</UL>
</p>
<a name="Return"></a>
<h2>Return value</h2>
<p>
A two-dimensional array dimensioned by the number of eigenvalues selected in
<a href="eofunc.html"><strong>eofunc</strong></a> by the size of the time dimension of <em>data</em>.
Will contain the following <a href="../../Language/attributes.html">
attribute</a>:
<ul>
<li>ts_mean: an array of the same size and type as <em>evec</em> containing the 
means removed from <em>data</em> as part of the calculation.</li>
</ul>
This <a href="../../Language/attributes.html">
attribute</a> can be accessed using the @ operator:
<pre>
<a href="print.html"><strong>print</strong></a>(<em>return_val</em>@ts_mean)
</pre>
</p><a name="Description"></a>
<h2>Description</h2>
<p>
Calculates the time series of the amplitudes associated with each
eigenvalue in an EOF. These amplitudes are also called principal
components, expansion coefficients, scores, etc. They are derived via
the dot product of the data and the EOF spatial patterns. The mean is
subtracted from the value of each component time series.<p>

Use <a href="eofunc_ts_n.html"><strong>eofunc_ts_n</strong></a> if your rightmost dimension is not
time, to avoid having to reorder the input
array. 
<p>
Use the <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a> function if metadata retention is desired.
The interface is identical.
<p>

To test the EOF time series for orthogonality, compute correlations.
If <em>neval=3</em> then

<pre>

  r01 = <a href="escorc.html"><strong>escorc</strong></a>(eof_ts(0,:), eof_ts(1,:))
  r12 = <a href="escorc.html"><strong>escorc</strong></a>(eof_ts(1,:), eof_ts(2,:))
  r02 = <a href="escorc.html"><strong>escorc</strong></a>(eof_ts(0,:), eof_ts(2,:))
  <a href="print.html"><strong>print</strong></a>("r01="+r01+"  r12="+r12+"  r02="+r02)   ; numbers may be +/- 1e-8 

</pre>
<p>


</p><a name="See_also"></a>
<h2>See Also</h2>
<p>
<a href="eofunc_ts_n.html"><strong>eofunc_ts_n</strong></a>,
<a href="../Contributed/eofunc_ts_n_Wrap.html"><strong>eofunc_ts_n_Wrap</strong></a>,
<a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a>,
<a href="eofunc.html"><strong>eofunc</strong></a>,
<a href="eofunc_n.html"><strong>eofunc_n</strong></a>,
<a href="../Contributed/eofunc_Wrap.html"><strong>eofunc_Wrap</strong></a>,
<a href="../Contributed/eofunc_north.html"><strong>eofunc_north</strong></a>,
<a href="../Contributed/eofunc_n_Wrap.html"><strong>eofunc_n_Wrap</strong></a>,
<a href="eof2data.html"><strong>eof2data</strong></a>, <a href="eof2data_n.html"><strong>eof2data_n</strong></a>,
<a href="eofunc_varimax.html"><strong>eofunc_varimax</strong></a>
</p><a name="Examples"></a>
<h2>Examples</h2>
<p>
<B>Example 1</B>
<p>
Let x be two-dimensional with dimensions "variables" (size = nvar) and "time":

<PRE>
  neval  = 3                         ; calculate 3 EOFs out of 7 
  ev     = <a href="eofunc.html"><strong>eofunc</strong></a>(x,neval,False)   ; ev(neval,nvar)
  
  option      = True
  option@jopt = 1                    ; use correlation matrix
  ev_cor = <a href="eofunc.html"><strong>eofunc</strong></a>(x,neval,option)  ; ev_cor(neval,nvar)

  ev_ts = <strong>eofunc_ts</strong>(x,ev_cor,False)

  ; Use <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a> if metadata retention is desired
  ; ev_ts = <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a>(x,ev_cor,False)
</PRE>

<B>Example 2</B>
<p>
Let x be three-dimensional with dimensions of time, lat, lon. 
<a href="../../Language/reorder.html">Reorder</a> x so that time
is the rightmost dimension:

<PRE>
  y!0    = "time"                  ; name dimensions if not already done 
  y!1    = "lat"                   ; must be named to reorder
  y!2    = "lon"                   

  neval  = nvar                                  ; calculate all EOFs 
  ev     = <a href="eofunc.html"><strong>eofunc</strong></a>(y(lat|:,lon|:,time|:),neval,False)   
  ; ev(neval,nlat,nlon)
  ev_ts = <strong>eofunc_ts</strong>(y(lat|:,lon|:,time|:),ev,False)

  ; Use <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a> if metadata retention is desired
  ; ev_ts = <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a>(y(lat|:,lon|:,time|:),ev,False)
</PRE>
<p>

To avoid making a copy of the array and reordering, use the "_n" version of these functions:
<p>
<PRE>
  ev     = <a href="eofunc_n.html"><strong>eofunc_n</strong></a>(y,neval,False,0)
  ; ev(neval,nlat,nlon)
  ev_ts = <a href="eofunc_ts_n.html"><strong>eofunc_ts_n</strong></a>(y,ev,False,0)

  ; Use <a href="../Contributed/eofunc_ts_n_Wrap.html"><strong>eofunc_ts_n_Wrap</strong></a> if metadata retention is desired
  ; ev_ts = <a href="../Contributed/eofunc_ts_n_Wrap.html"><strong>eofunc_ts_n_Wrap</strong></a>(y,ev,False,0)
</PRE>

<B>Example 3</B>
<p>
Let z be four-dimensional with dimensions lev, lat, lon, and time:

<PRE>
  neval  = 3                       ; calculate 3 EOFs out of klev*nlat*mlon 
  ev     = <a href="eofunc.html"><strong>eofunc</strong></a>(z,neval,False)      
; ev will be dimensioned neval, level, lat, lon
  ev_ts = <strong>eofunc_ts</strong>(z,ev,False)

  ; Use <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a> if metadata retention is desired
  ; ev_ts = <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a>(z,ev,False)
</PRE>

<B>Example 4</B>
<p> Calculate the EOFs at every other lat/lon point. Use of a temporary 
array is NOT necessary but it avoids having to reorder the array twice in
this example:

<PRE>
  neval  = 5                          ; calculate 5 EOFs out of nlat*mlon 
  zTemp  = z(lat|::2,lon|::2,time|:)  ; reorder and use temporary array
  ev     = <a href="eofunc.html"><strong>eofunc</strong></a>(zTemp,neval,False)   ; ev(neval,nlat/2,mlon/2)
  ev_ts = <strong>eofunc_ts</strong>(zTemp,ev,False)

  ; Use <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a> if metadata retention is desired
  ; ev_ts = <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a>(zTemp,ev,False)
</PRE>
<p>

To avoid making a copy of the array and reordering, use the "_n" version of these functions:
<p>

<PRE>
  neval = 5                          ; calculate 5 EOFs out of nlat*mlon 
  ev    = <a href="eofunc_n.html"><strong>eofunc_n</strong></a>(z(:,::2,::2),neval,False,0)   ; ev(neval,nlat/2,mlon/2)
  ev_ts = <a href="eofunc_ts_n.html"><strong>eofunc_ts_n</strong></a>(z,ev,False,0)

  ; Use <a href="../Contributed/eofunc_ts_n_Wrap.html"><strong>eofunc_ts_n_Wrap</strong></a> if metadata retention is desired
  ; ev_ts = <a href="../Contributed/eofunc_ts_n_Wrap.html"><strong>eofunc_ts_n_Wrap</strong></a>(z,ev,False,0)
</PRE>
<p>


<B>Example 5</B>
<p>
Let z be four-dimensional with dimensions level, lat, lon, time. Calculate the
EOFs at one specified level:

<PRE>
  kl     = 3                               ; specify level
  neval  = 8                               ; calculate 8 EOFs out of nlat*mlon 
  ev     = <a href="eofunc.html"><strong>eofunc</strong></a>(z(kl,:,:,:),neval,False)  
; ev will be dimensioned neval, lat, lon 

  optETS      = True
  optETS@jopt = 1
  ev_rot = <strong>eofunc_ts</strong>(z,ev,optETS)

  ; Use <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a> if metadata retention is desired
  ; ev_rot = <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a>(z,ev,optETS)
</PRE>

<B>Example 6</B>
<p>
Let z be four-dimensional with dimensions time, lev, lat, lon. 
<a href="../../Language/reorder.html">Reorder</a> x so that time
is the rightmost dimension and calculate on one specified level:

<PRE>
  kl     = 3                             ; specify level
  neval  = 8                             ; calculate 8 EOFs out of nlat*mlon 
  zTemp  = z(lev|kl,lat|:,lon|:,time|:)   
  ev     = <a href="eofunc.html"><strong>eofunc</strong></a>(zTemp,neval,False)      
; ev will be dimensioned neval, lat, lon
  ev_ts = <strong>eofunc_ts</strong>(zTemp,ev,False)

  ; Use <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a> if metadata retention is desired
  ; ev_ts = <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a>(zTemp,ev,False)
</PRE>
<p>

To avoid making a copy of the array and reordering, use the "_n" version of these functions:
<p>

<PRE>
  kl     = 3                             ; specify level
  neval  = 8                             ; calculate 8 EOFs out of nlat*mlon 
  ev    = <a href="eofunc_n.html"><strong>eofunc_n</strong></a>(z,neval,False,0)  
; ev will be dimensioned neval, lat, lon
  ev_ts = <a href="eofunc_ts_n.html"><strong>eofunc_ts_n</strong></a>(z,ev,False,0)

  ; Use <a href="../Contributed/eofunc_ts_n_Wrap.html"><strong>eofunc_ts_n_Wrap</strong></a> if metadata retention is desired
  ; ev_ts = <a href="../Contributed/eofunc_ts_n_Wrap.html"><strong>eofunc_ts_n_Wrap</strong></a>(z,ev,False,0)

</PRE>

<B>Example 7</B>
<p>
Area-weight the data prior to calculation. Let p be three-dimensional with 
dimensions time x lat x lon. The array lat contains the latitudes.

<PRE>
; calculate the weights using the square root of the cosine of the latitude and
; also convert degrees to radians
  wgt = <a href="sqrt.html"><strong>sqrt</strong></a>(<a href="cos.html"><strong>cos</strong></a>(lat*0.01745329)) 
  
; <a href="../../Language/reorder.html">reorder</a> data so time is fastest varying
  pt  = p(lat|:,lon|:,time|:)         ; (lat,lon,time)
  ptw = pt                            ; create an array with metadata

; weight each point prior to calculation. 
; <a href="conform.html"><strong>conform</strong></a> is used to make wgt the same size as pt
  ptw = pt*<a href="conform.html"><strong>conform</strong></a>(pt, wgt, 0)        
                                      
  evec    = <a href="eofunc.html"><strong>eofunc</strong></a>(ptw,neval,80.)   
  evec_ts = <strong>eofunc_ts</strong>(ptw,evec,False)

  ; Use <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a> if metadata retention is desired
  ; evec_ts = <a href="../Contributed/eofunc_ts_Wrap.html"><strong>eofunc_ts_Wrap</strong></a>(ptw,evec,False)
</PRE>
<p>

To avoid making a copy of the array and reordering, use the "_n" version of these functions:
<p>
<PRE>
; calculate the weights using the square root of the cosine of the latitude and
; also convert degrees to radians
  wgt = <a href="sqrt.html"><strong>sqrt</strong></a>(<a href="cos.html"><strong>cos</strong></a>(lat*0.01745329)) 
  
  pw = p                            ; create an array with metadata

; weight each point prior to calculation. 
; <a href="conform.html"><strong>conform</strong></a> is used to make wgt the same size as pt
  ptw = pt*<a href="conform.html"><strong>conform</strong></a>(pt, wgt, 1)
                                      
  evec    = <a href="eofunc_n.html"><strong>eofunc_n</strong></a>(ptw,neval,80.,0)
  evec_ts = <a href="eofunc_ts_n.html"><strong>eofunc_ts_n</strong></a>(ptw,evec,False,0)

  ; Use <a href="../Contributed/eofunc_ts_n_Wrap.html"><strong>eofunc_ts_n_Wrap</strong></a> if metadata retention is desired
  ; evec_ts = <a href="eofunc_ts_n.html"><strong>eofunc_ts_n</strong></a>(ptw,evec,False,0)
</PRE>
</p>					</div>

					<p>&nbsp;</p>

		<!-- begin footer -->
		<div id="footer">
		
		<a href="mailto:ncladmin@ucar.edu">Contact the Webmaster</a>



		<!-- end footer -->
		</div>

           <br class="clearboth"/>

	   <!-- end content -->
	</div>
<!-- end wrap -->
</div>
</body>

<!-- Mirrored from www.ncl.ucar.edu/Document/Functions/Built-in/eofunc_ts.shtml by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 17 May 2025 15:18:27 GMT -->
</html>
